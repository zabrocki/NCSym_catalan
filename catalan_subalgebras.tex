\documentclass[11pt]{amsart}

%\usepackage{amsthm}

\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage[colorlinks=true, pdfstartview=FitV, linkcolor=blue, citecolor=blue, urlcolor=blue]{hyperref}

\usepackage[centering]{geometry}                % See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   % ... or a4paper or a5paper or ...
%\geometry{landscape}                % Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{epstopdf} 
\usepackage{lscape} 
\usepackage{xcolor} 
\usepackage[utf8]{inputenc} 
\usepackage{tikz,caption} 
\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}
\usepackage{enumitem}
\setlist[itemize]{leftmargin=2em}
\setlist[enumerate]{leftmargin=2em}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{mathtools}
\usepackage{mathrsfs}
\usepackage[aligntableaux=center, smalltableaux]{ytableau}
\usepackage{youngtab}
\usepackage{verbatim}
\usepackage{faktor}
\usepackage{xspace}
\usepackage{esvect}
\usepackage{stmaryrd}
%\usepackage{showframe}

\definecolor{darkblue}{rgb}{0.0,0,0.7} % darkblue color
\definecolor{darkred}{rgb}{0.7,0,0} % darkred color
\definecolor{darkgreen}{rgb}{0, .6, 0} % darkgreen color

% Dark red emphasis
\newcommand{\defncolor}{\color{darkred}}
\newcommand{\defn}[1]{{\defncolor\emph{#1}}} % emphasis of a definition
\newcommand{\arxiv}[1]{\href{http://arxiv.org/abs/#1}{\texttt{arXiv:#1}}}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{property}[theorem]{Property}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{question}[theorem]{Question}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{conjecture}[theorem]{Conjecture}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{problem}[theorem]{Problem}
\numberwithin{equation}{section}

\def\NN{{\mathbb N}}
\def\CC{{\mathbb C}}
\def\ZZ{{\mathbb Z}}
\def\QQ{{\mathbb Q}}

\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\st}{st}

\newcommand{\FGCCHA}{\textsf{FGCCHA}\xspace}
\newcommand{\FGCCHAs}{\textsf{FGCCHA}s\xspace}
\newcommand{\vecdim}{\overrightarrow{\dim}}
\newcommand{\veccard}{\overrightarrow{\operatorname{card}}}
\newcommand{\OPG}{\operatorname{OPG}}

\newcommand{\NCSym}{\mathsf{NCSym}}
\newcommand{\Bell}{\mathbf{B}}
\newcommand{\Catalan}{\mathbf{C}}

\usepackage[colorinlistoftodos]{todonotes}

\newcommand{\mike}[1]{\todo[size=\tiny,color=green!30]{#1 \\ \hfill --- Mike}}
\newcommand{\lucas}[1]{\todo[size=\tiny,color=red!50]{#1 \\ \hfill --- Lucas}}
\newcommand{\felix}[1]{\todo[size=\tiny,color=Cyan]{#1 \\ \hfill --- FÃ©lix}}
\newcommand{\farhad}[1]{\todo[size=\tiny,color=blue!50]{#1 \\ \hfill --- Farhad}}
\newcommand{\eric}[1]{\todo[size=\tiny,color=BurntOrange!50]{#1 \\ \hfill --- Eric}}
\newcommand{\nicolas}[1]{\todo[size=\tiny,color=purple!50]{#1 \\ \hfill --- Nicolas}}
\setlength{\marginparwidth}{28mm}

\title{When are Hopf algebras determined by integer sequences?}
\author{Nicolas Andrews, Lucas Gagnon, F\'{e}lix G\'{e}linas, Eric Schlums, Mike Zabrocki}

\begin{document}
\maketitle
\begin{abstract}
%attempt 1
We study the category of graded Hopf algebras that are
free noncommutative, cocommutative,
graded and connected
from the perspective of the sequences of dimensions of the graded pieces.
We show that a Hopf algebra exists with a given sequence of graded dimensions
if and only if the ``INVERTi'' transformation of the sequence is nonnegative.
We give conditions on the sequences of graded dimensions for two Hopf algebras $H$ and $K$
in this category under which there exists a surjective homomorphism from $H$ to $K$.
We also give conditions such that an isomorphic copy of
$H$ occurs as a Hopf subalgebra of $K$.
\end{abstract}

\begin{comment}
%attempt 2
We study the category of free, graded, connected, cocommutative Hopf algebras
by what can be said from the sequence of graded dimensions.
Let $\vec{a} = (a_1, a_2, a_3, \ldots)$ be a sequence of nonnegative integers,
then a Hopf algebra $H := \bigoplus_{n\geq0} H_n$ such that 
$a_n = \dim H_n$ if and only if a transformation of $\vec{a}$ is nonnegative.
If $H$ and $K$ are graded Hopf algebras then state conditions on the dimension
sequences of $H$ and $K$...
\end{comment}

\setcounter{tocdepth}{1}
\tableofcontents

\section{Introduction}

This paper begins with a question about the Hopf algebra of symmetric functions in noncommutative variables, $\NCSym$~\cite{AgEtAl12, BHRZ05, GebSag01, HNT08, RS06, W36}.  
This is a graded Hopf algebra with dimensions given by the Bell numbers, and many well-known bases of $\NCSym$ are naturally indexed by set partitions.  
The Catalan numbers enumerate several distinguished families of partitions, including the nonnesting and noncrossing set partitions.  
We recognized that some bases of $\NCSym$ had product and coproduct formulas that were closed when restricted to the nonnesting or noncrossing subsets, meaning that these sets spanned a Hopf subalgebra of $\NCSym$.

\begin{problem}
\label{problem:motivating_calatan_question}
Classify all Hopf subalgebras of $\NCSym$ with graded dimensions equal to the Catalan numbers.
\end{problem}

%Exploring this question led us to consider the more 
%This led us to the natural extension of this question to any interesting sequence 
%   
%\begin{problem}
%\label{problem:Catalan_hopfsub_classify_all}
%Classify all Hopf subalgebras of $\NCSym$ .
%\end{problem}

We resolve Problem~\ref{problem:motivating_calatan_question} up to isomorphism by applying a recent result of Aliniaeifard and Thiem~\cite{AT22} and the Shirshov--Witt Theorem~\cite{S09, Witt56}.  
The former result applies to every member of the full subcategory of free, graded, connected, and cocommutative Hopf algebras, which we will abbreviate as \FGCCHA.  
As stated above, this includes $\NCSym$.  
%This is a consequence of the category in which $\NCSym$ lies, and applies to a much larger class of Hopf algebras.  
%This category is the full subcategory of free, graded, connected, and cocommutative Hopf algebras, which we will denote by \FGCCHA. 
In the context of \FGCCHAs,~\cite[Theorem~4.2]{AT22} show that that the isomorphism class of an
\FGCCHA $H$ can be fully determined by the \emph{dimension sequence}
\[
\vecdim(H) = \big( \dim(H_{1}), \dim(H_{2}), \dim(H_{3}), \ldots \big)
\qquad\text{where}\qquad
H = \bigoplus_{n \ge 0} H_{n}.
\]
We answer Problem~\ref{problem:motivating_calatan_question} by showing that all Hopf subalgebras of any \FGCCHA (including $\NCSym$) are \FGCCHAs, a fact that we deduce from the Shirshov--Witt Theorem; see Lemma~\ref{lem:ShiWitt}.  


Beyond $\NCSym$, much work has gone into understanding specific examples including the \FGCCHAs of noncommutative symmetric functions (see Example~\ref{ex:NSym}), permutations (see Example~\ref{example:hopf_algebras_of_permutations}), and trees~\cite{AS05cc, GL09}.  
At a more general level, properties of the category of \FGCCHAs (or its dual) have been considered in several references~\cite{AT22, Block85, FP24, LodayRonco10, MM65, Reutenauer-FreeLieAlgebras}, and key results appear in Loday's work on triples of operads which includes \FGCCHAs as a sub-category~\cite[Section 4.1]{L08}.  

The particular ingredients of Aliniaefard and Thiem's result comes from Loday's generalization of the  Cartier--Milnor--Moore and Poincar\'{e}--Birkhoff--Witt theorems~\cite[Theorem 4.1.3]{L08}.  These results state that the structure of an \FGCCHA $H$, is completely determined by the dimension of the subspace of primitives in $H$ and the size of a free generating set of $H$, respectively.

Foissy \cite{F12} has studied the category of free and cofree Hopf algebras from a similar perspective. 
In~\cite[Proposition 23]{F12}, Foissy finds that free and cofree Hopf algebras are also determined by the sequences of
graded dimensions.  
The present work assembles a similar toolbox for the category of \FGCCHAs by collecting known results from the literature.
%This paper collects some  as a toolbox for what can be deduced about examples in from associated sequences of integers.

Building on known properties of \FGCCHAs (Theorem~\ref{thm:AT}, Proposition~\ref{prop:LieToFree}, Proposition~\ref{prop:indecomposable generators}, Lemma~\ref{lemma:primitive generators}, and Proposition \ref{lem:ShiWitt}), this perspective allows us to determine whether maps between \FGCCHAs exist by checking properties of the sequences.  
For example, proving that two \FGCCHAs have equal dimension sequences amounts to showing that they are isomorphic, by Aliniaeifard and Thiem's result.

The sections of this paper are structured as follows.
Sections~\ref{sec:SequencePrelims} and~\ref{sec:HopfAlgebra} state the
relationship between the dimension of an \FGCCHA, the number of free generators,
and the dimension of the Lie algebra of primitives. Section~\ref{sec:SequencePrelims}
establishes preliminary notation about sequences, while Section~\ref{sec:HopfAlgebra}
focuses on the algebraic content.

In Section~\ref{sec:isoclassification} we interpret a result by
Aliniaeifard and Thiem as a characterization of \FGCCHAs by their
sequence of graded dimensions and Theorem~\ref{thm:a sequence}
states that a sequence of nonnegative integers is the graded
dimensions of an \FGCCHA if and only if the INVERTi transform~\cite{OEIS}
of the sequence is nonnegative.
Theorem~\ref{thm:OPGmaps} describes an explicit construction of the
isomorphisms between \FGCCHAs and a canonical representative of each isomorphism class.

In the last two sections we use the association between \FGCCHAs
and sequences from Section~\ref{sec:isoclassification}
to describe the structure of the category of \FGCCHAs.
In Section~\ref{sec:surjection}, Theorem~\ref{thm:surjection} 
shows that there exists a surjective homomorphism from an \FGCCHA with
dimension sequence $\vec{h}$ to an \FGCCHA with dimension sequence 
$\vec{k}$ if and only if the INVERTi transform of $\vec{k}$ is dominated by 
the INVERTi transform of $\vec{h}$.
In the last section, Theorem~\ref{thm:subclassification2} states
that an \FGCCHA  with dimension sequence $\vec{h}$ occurs as a Hopf 
subalgebra of an \FGCCHA with dimension sequence $\vec{k}$ if and only if 
the inverse Euler transform of $\vec{k}$ dominates the inverse Euler transform of $\vec{h}$.  
This can be used to classify all Hopf subalgebras of \FGCCHAs.

\vspace{4ex}

We illustrate our results by describing how they can be applied to resolve Problem~\ref{problem:motivating_calatan_question}.  
As stated above, the dimension sequence of $\NCSym$ is the Bell numbers,
\[
\vecdim(\NCSym) = (1, 2, 5, 15, 52, 203, \ldots)
\qquad\text{see~\cite[\href{https://oeis.org/A000110}{A000110}]{OEIS}.}
\]
Every Hopf subalgebra of $\NCSym$ corresponds to a sequence whose inverse Euler transform is dominated by $(1, 1, 3, 9, 34, 135,\ldots)$~\cite[\href{https://oeis.org/A085686}{A085686}]{OEIS}, which is  the inverse Euler transform of the Bell numbers.  
In particular, the Catalan numbers $(1, 2, 5, 14, 42, 132, \ldots)$~\cite[\href{https://oeis.org/A000108}{A000108}]{OEIS} have inverse Euler transform $(1, 1, 3, 8, 25, 75,\ldots)$~\cite[\href{https://oeis.org/A022553}{A022553}]{OEIS}, which is dominated by~\cite[\href{https://oeis.org/A085686}{A085686}]{OEIS}.  
Therefore $\NCSym$ has a Hopf subalgebra with Catalan dimension, which is unique up to isomorphism; in the following we identify such a sub-Hopf algbera and then a well-known representative of its isomorphism class.  

%\begin{example}
Our example uses the power-sum basis $\{\mathbf{p}_{\pi} \;|\; \text{$\pi$ is a set partition of $[n]$, $n \ge 0$}\}$ of $\mathsf{NCSym}$; see~\cite{BHRZ05} for details on the Hopf structure on this basis.  
Direct calculation shows that the subset $\{\mathbf{p}_{\pi} \;|\; \text{$\pi$ is noncrossing}\}$ is closed under the product and coproduct, so they span a Hopf subalgebra whose dimension is the Catalan numbers.  
There are many more examples including the one constructed in~\cite{AT20}.

In~\cite{NT05} Novelli and Thibon define a graded connected Hopf algebra $\mathbf{CQSym}$ which has a basis $\mathbf{P}^{\pi}$ indexed by noncrossing set partitions $\pi$.  
This Hopf algebra is manifestly cocommutative and~\cite[Proposition 5.2]{NT05} shows that it is free, so $\mathbf{CQSym}$ is an \FGCCHA.  
Moreover, the number of noncrossing set partitions is the Catalan numbers.

Using Aliniaefard and Thiem's result, $\mathbf{CQSym}$ is isomorphic to every Hopf subalgebra of $\NCSym$ with graded dimensions equal to the Catalan numbers, and in particular to $\{\mathbf{p}_{\pi} \;|\; \text{$\pi$ is noncrossing}\}$.  
It is important to note that this does not immediately produce an isomorphisms, as the product and the coproduct on the bases $\mathbf{P}^{\pi}$ from~\cite{NT05} and $\mathbf{p}_{\pi}$ from~\cite{BHRZ05} are not the same.

\section{Combinatorics of sequences of numbers}
\label{sec:SequencePrelims}

Let $\QQ^{\ZZ_+}$ (respectively $\ZZ^{\ZZ_+}$ and $\NN^{\ZZ_+}$) denote the space of infinite sequences
$(c_{n})_{n \ge 1} = (c_{1}, c_{2}, \ldots)$ of rational (respectively, integer and natural) numbers,
i.e.~$c_{n} \in \QQ$ for all $n \ge 1$.
Given two sequences $\vec{c} = (c_{1}, c_{2}, \ldots)$ and $\vec{d} = (d_{1}, d_{2}, \ldots)$, we write
\[
\vec{c} \le \vec{d} 
\qquad\text{if and only if}\qquad
\text{$c_{n} \le d_{n}$ for all $n \ge 1$}.
\]
Let $\vec{0} \in \QQ^{\ZZ_+}$ denote the zero sequence, so that $\vec{c} \ge \vec{0}$
if and only if $\vec{c}$ consists entirely of nonnegative entries.

Our main results make use of three interrelated sequences that we will denote by $\vec{h}$, $\vec{a}$, and $\vec{p}$.  
In this section we take a purely enumerative perspective to these sequences, assuming only that they satisfy the relation given in Equation~\eqref{eq:gf_relation} and may have values from a field containing $\QQ$.  

However, in later sections these sequences come from an \FGCCHA $H$
and have an interpretation showing that they are nonnegative integers.
For a graded vector space $V = \bigoplus_{n \ge 0} V_{n}$ with $V_{0} = \CC$, let
\[
\vecdim(V) = \left( \dim(V_{n}) \right)_{n \ge 1}.
\]
Similarly, for a graded set $X = \biguplus_{n \ge 1} X^{(n)}$, let
\[
\veccard(X) = \left( |X^{(n)}| \right)_{n \ge 0}~.
\]
This interpretation will provide useful motivation here:
\begin{itemize}
\item $\vec{h} = (h_{1}, h_{2}, \ldots)$ will be the graded dimensions of $H$,

\item $\vec{a} = (a_{1}, a_{2}, \ldots)$ will be the graded numbers of free generators of the algebra, and 

\item $\vec{p} = (p_{1}, p_{2}, \ldots)$ will be the graded dimension of the Lie algebra of primitives $\mathcal{P}(H)$.

\end{itemize}

To define our sequences, we make use of the fact, recorded in Proposition~\ref{prop:sequences}
below, that any formal power series in $\QQ[\![t]\!]$ with constant term $1$
can be expressed in three equivalent ways,
\begin{equation}
\label{eq:gf_relation}
1 + \sum_{k \geq 1} h_k t^k = \frac{1}{1 - \sum_{m \geq 1} a_m t^m} = \prod_{d \geq 1} \frac{1}{(1-t^d)^{p_d}}~.
\end{equation}
which determines a triple of sequences: $(\vec{h}, \vec{a}, \vec{p})$ with $\vec{h} = (h_{1}, h_{2}, \ldots)$, $\vec{a} = (a_{1}, a_{2}, \ldots)$, and $\vec{p} = (p_{1}, p_{2}, \ldots)$.

\begin{example}
Take $f(t) = 1 + 2t + 3 t^{2} + \cdots \in \QQ[\![t]\!]$, so that $\vec{h} = (2, 3, 4, \ldots)$.
Then $f(t)$ is the power series,
\[
f(t) = \frac{1}{1 - 2 t^{2} + t^{2}} = \frac{1}{(1-t)^{2}}
\]
so the remaining sequences are $\vec{a} = (2, -1, 0, \ldots)$ and $\vec{p} = (2, 0, 0, \ldots)$.
\end{example}
A \defn{composition} of $n$ is a sequence $\beta = (\beta_1, \beta_2, \ldots, \beta_\ell)$ of positive integers such that $\beta_{1} + \beta_{2} + \cdots + \beta_{\ell} = n$.  
We refer to the integers $\beta_{i}$ as the parts of $\beta$ and write $\ell(\beta)$ for the length of $\beta$, which is the number of parts.  
We will use the notation $\beta \vDash n$ to indicate that $\beta$ is a composition of $n$.

We say that $\lambda \vDash n$ is a \defn{partition} of $n$ if $\lambda_1 \geq \lambda_2 \geq \cdots \geq \lambda_{\ell(\lambda)}$.  We will indicate that $\lambda$ is a partition
of $n$ with the notation $\lambda \vdash n$.  We will also use the notation $m_d(\lambda)$ to be the number of times
that $d$ appears as a part in $\lambda$.

For a composition $\alpha = (\alpha_{1}, \alpha_{2}, \ldots, \alpha_{\ell}) \vDash n$,
define for the sequence $\vec{c} = (c_{1}, c_{2}, \ldots) \in \QQ^{\ZZ_+}$,
\[
c_{\alpha} = c_{\alpha_{1}} c_{\alpha_{2}} \cdots c_{\alpha_{\ell}}.
\]
Note that $c_{\alpha} = c_{\beta}$ whenever $\beta \vDash n$ is a composition with the same parts as $\alpha$ in a possibly different order, i.e.~ $\beta_{i} = \alpha_{\sigma(i)}$ for some permutation $\sigma$ of the integers $\{1,2, \ldots, \ell(\alpha)\}$.


We will make extensive use of explicit formulas relating the sequences $\vec{h}$, $\vec{p}$, and $\vec{a}$.  The following formula can be derived directly from Equation~\eqref{eq:gf_relation} using standard techniques.  A form of the first part of (iii) below also appears in~\cite[Theorem 2.2]{KK95} as the ``generalized Witt's formula.''

\begin{proposition}
\label{prop:sequences}
Any one sequence $\vec{h}$, $\vec{a}$, or $\vec{p} \in \QQ^{\ZZ_+}$ belongs to a unique triple $(\vec{h}, \vec{a}, \vec{p})$ of sequences that satisfy Equation~\eqref{eq:gf_relation}, given by:
\begin{enumerate}[label = (\roman*), itemsep = 1em]
\item $\displaystyle h_{n}
= \sum_{\beta \vDash n} a_\beta
= \sum_{\lambda \vdash n} \prod_{d \geq 1} \binom{p_d + m_d(\lambda) -1}{m_d(\lambda)}$, 

\item $\displaystyle a_n
= \sum_{\beta \vDash n} (-1)^{\ell(\beta)-1} h_\beta
= \sum_{\lambda \vdash n} (-1)^{\ell(\lambda)-1} \prod_{d \geq 1} \binom{p_d}{m_d(\lambda)}$, and

\item $\displaystyle p_n
= \sum_{d|n} \sum_{\beta \vDash d} \frac{d\cdot \mu(n/d)}{n \cdot \ell(\beta)} a_\beta
= \sum_{d|n} \sum_{\beta \vDash d} \frac{d\cdot \mu(n/d) (-1)^{\ell(\beta)-1}}{n \cdot \ell(\beta)} h_\beta$.

\end{enumerate}
\end{proposition}


\begin{remark} Although not necessarily obvious, the interested reader can verify using an induction argument that if $\vec{a} \in \ZZ^{\ZZ_+}$ or $\vec{h} \in \ZZ^{\ZZ_+}$, then $\vec{p} \in \ZZ^{\ZZ_+}$.
\end{remark}

%\begin{proof}
%%We will make use of the identities
%%\[
%%(1-t)^p = \sum_{k \geq 0} \binom{p}{k} t^k, \quad
%%\frac{1}{(1-t)^p} = \sum_{k \geq 0} \binom{p+k-1}{p-1} t^k, \quad\text{and}\quad
%%\log(1-t) = \sum_{j \geq 1} \frac{t^j}{j}
%%\]
%%to derive equations (i)--(iii) from Equation \eqref{eq:gf_relation}.
%
%In order to see (i), take the series expansion of the second
%and third expressions in Equation \eqref{eq:gf_relation} to obtain
%\begin{equation}\label{eq:gf_relation_reciprocal}
%1 + \sum_{k \geq 1} h_k t^k
%= \sum_{k \geq 0} \left(\sum_{m \geq 1} a_m t^m\right)^k
%= \prod_{d \geq 1} \left(\sum_{k \geq 0} \binom{p_d+k-1}{k} t^{kd}\right).
%\end{equation}
%Expanding each product of sums and isolating the coefficient of $t^{n}$ in each expression gives the desired equation.
%
%Now we prove (ii).  Take the reciprocal of Equation \eqref{eq:gf_relation}
%and isolate the sum over $m$ to obtain
%\[
%1 - \frac{1}{1 + \sum_{k \geq 1} h_k t^k} 
%= \sum_{m \geq 1} a_m t^m 
%= 1 - \prod_{d \geq 1} (1-t^d)^{p_d}.
%\]
%Expanding the left- and rightmost expressions yields
%\[
%\sum_{r \geq 1} (-1)^{r-1} \left(\sum_{k \geq 1} h_k t^k\right)^r
%= \sum_{m \geq 1} a_m t^m
%= 1 - \prod_{d \geq 1} \sum_{k \geq 0} (-1)^k \binom{p_d}{k} t^{dk}.
%\]
%Isolating the coefficient of $t^{n}$, we obtain equation (ii).
%
%Finally, we deduce (iii).  Beginning with Equation \eqref{eq:gf_relation} as above,
%take the logarithm of each term and Taylor expand about $1$ to obtain
%\[
% \sum_{r \geq 1} \frac{(-1)^{r-1}(\sum_{k \geq 1} h_k t^k )^r}{r}
%= \sum_{r \geq 1} \frac{(\sum_{m \geq 1} a_m t^m )^r}{r}
%= \sum_{d \geq 1} \sum_{j \geq 1} p_d \frac{t^{jd}}{j}.
%\]
%Now we isolate the coefficient of $t^{n}$ in each of the expressions: 
%\[
%\sum_{\beta \vDash n} \frac{(-1)^{\ell(\beta)-1} h_\beta}{\ell(\beta)}
%= \sum_{\beta \vDash n} \frac{a_\beta}{\ell(\beta)}
%= \frac{1}{n} \sum_{d | n} d p_{d} .
%\]
%Lastly, multiply the equation by $n$ and apply M\"{o}bius inversion to solve for $n p_{n}$.
%\end{proof}

Proposition \ref{prop:sequences} is biconditional in the sense that given any equality in the proposition, reversing the calculations shows that the corresponding generating function relations in Equation~\eqref{eq:gf_relation}
will hold.  (See e.g.~\cite{AL15} below Equation (33).)

\begin{definition}
\label{defn:sequencetransfer}
The \emph{sequence transfer maps} relate sequences $(\vec{a}, \vec{h}, \vec{p})$ satisfying Equation~\eqref{eq:gf_relation}:
\begin{align*}
\begin{array}{rcl}
\phi_{p, a} : \QQ^{\ZZ_+} & \to & \QQ^{\ZZ_+} \\
\vec{p} & \mapsto & \vec{a}
\end{array},
\qquad
\begin{array}{rcl}
\phi_{h, a} : \QQ^{\ZZ_+} & \to & \QQ^{\ZZ_+} \\
\vec{h} & \mapsto & \vec{a}
\end{array},
\qquad\text{and}\qquad 
\begin{array}{rcl}
\phi_{p, h} : \QQ^{\ZZ_+} & \to & \QQ^{\ZZ_+} \\
\vec{p} & \mapsto & \vec{h}
\end{array}
\end{align*}
as well as their inverses
\[
\phi_{a, p} = \phi_{p, a}^{-1},
\qquad\qquad
\phi_{a, h} = \phi_{h, a}^{-1},
\qquad\qquad\text{and}\qquad\qquad
\phi_{h, p} = \phi_{p, h}^{-1}.
\]
\end{definition}

Following the conventions of \cite{OEIS}, the map $\phi_{p,h}$ is known
as the Euler transform of the sequence
(and consequently $\phi_{h,p}$ is the inverse Euler transform).
Also following the conventions
of \cite{OEIS},
the map $\phi_{a,h}$ is known as the INVERT transform
and $\phi_{h,a}$ is the INVERTi transform.

\begin{example}
\label{ex:catalan}
Take $f(t) = 1 + t + 2 t^{2} + 5t^3 + 14t^4 + \cdots \in \QQ[[t]]$,
so that $h_n$ is equal to the $n^{th}$ Catalan number
$\frac{1}{n+1}\binom{2n}{n}$.  It is well known that $f(t)$ satisfies the functional equation
\[
f(t) = \frac{1}{1 - t - t^2 - 2t^3 - 5t^4 - 14t^5 - \cdots} = \frac{1}{1-t f(t)}
\]
so we have that $\phi_{h,a}(1,2,5,14,42,132,\ldots) = \vec{a} = (1,1,2,5,14,42, \ldots)$
(that is, $a_n$ is the $n-1^{st}$ Catalan number).
We can use Proposition~\ref{prop:sequences} to calculate the first few values of $\vec{p} = (1,1,3,8,25, \ldots)$.
It follows from \cite[\S 5.1.3]{NT05} that $\vec{p}$ is equal to sequence \cite[\href{https://oeis.org/A022553}{A022553}]{OEIS}.
\end{example}

If the sequence $\vec{a}$ consists entirely of nonnegative integers,
then $\vec{h} = \phi_{a, h}(\vec{a})$ and $\vec{p} = \phi_{a, p}(\vec{a})$ will also have combinatorial interpretation in terms of words.
Recall that a word in a set $X$ is a finite sequence $w = w_{1} w_{2} \ldots w_{\ell}$ of ``letters'' $w_{i} \in X$.  
If $X = \biguplus_{n \geq 1} X^{(n)}$ is a graded set, then define the \emph{degree} of a word to be
\[
\mathsf{deg}(w_1 w_2 \ldots w_{\ell}) = \sum_{i = 1}^{\ell} \mathsf{deg}(w_{i})
\qquad\text{where $\mathsf{deg}(x) = n$ for all $x \in X^{(n)}$}.
\]
For a fixed order on $X$, we order the words on $X$ lexicographically.  
The \emph{rotation} of a word $w = w_{1} w_{2} \ldots w_{\ell}$ is the word
\[
\mathsf{cyc}(w) =  w_{2} \ldots w_{\ell} w_{1}.
\]
This defines an operation of order $\ell$ on words of with $\ell$ letters.  
A word is \emph{Lyndon} if it is strictly smaller than each of $\mathsf{cyc}(w), \mathsf{cyc}^{2}(w), \ldots, \mathsf{cyc}^{\ell-1}(w)$.  
For instance, if $X = \{x < y\}$, then $xyxyy$ is a Lyndon word, but neither $xyxy$ nor $xyx$ are: $xyxy = \mathsf{cyc}^{2}(xyxy)$, while $xyx > xxy = \mathsf{cyc}^{2}(xyx)$.

If the sequence $\vec{a}$ is of nonnegative integers rather than
any values from a field, there is a combinatorial interpretation for
$\phi_{a, h}(\vec{a})$ and $\phi_{a, p}(\vec{a})$.
Similar results are well-known and appear in expositions such as~\cite[Chapter 5]{Reutenauer-FreeLieAlgebras}.  
The exact statement below appears in~\cite[p.~566]{AL15}, which the authors attribute in part to~\cite{KK95}.

\begin{proposition}
\label{prop:combinatorialinterpretation}
Let $\vec{a} \in \NN^{\ZZ_+}$ so that there exists a graded set $X = \biguplus_{n \geq 1} X^{(n)}$ with $\veccard(X) = \vec{a}$.
If $\vec{h} = \phi_{a, h}(\vec{a})$ and $\vec{p} = \phi_{a, p}(\vec{a})$, then for each $n \geq 1$, we have:
\begin{enumerate}[itemsep = 0.5em]
\item $h_n$ is equal to the number of words of degree $n$ in the alphabet $X$ for all $n \ge 1$, and 

\item $p_n$ is equal to the number of Lyndon words of degree $n$ in the alphabet $X$ for all $n \ge 1$.
\end{enumerate}
\end{proposition}

%\begin{proof}
%To see (1), note that any degree $n$ word $w = w_1 w_2 \cdots w_{\ell}$ in $X$
%defines a unique composition $(\mathsf{deg}(w_{1}), \mathsf{deg}(w_{2}), \ldots, \mathsf{deg}(w_{\ell}))$,
%and for a particular composition $\beta \vDash n$,
%every $w \in X^{(\beta_{1})} \times X^{(\beta_{2})} \times \cdots \times X^{(\beta_{\ell})}$ has this property.
%Thus, the number of degree $n$ words in $X$ agrees with the formula for $h_{n}$ given in Proposition~\ref{prop:sequences} (i).  
%
%For the second point the reader may refer to \cite[Theorem 4.9, Theorem 5.1]{Reutenauer-FreeLieAlgebras}
%for a more complete exposition.
%
%The proof will make use of the set
%\[
%I_{n} = \{ (i, w) \;|\; \text{degree $n$ words $w$ in $X$ and $1 \le i \le \mathsf{deg}(w_{1})$}\},
%\]
%which has size
%$
%|I_{n}| = \sum_{\beta \vDash n} \beta_{1} a_{\beta} .
%$
%Note that since $a_\beta = a_{\mathsf{cyc}^k(\beta)}$, then we have
%\[
%|I_{n}|
%= \sum_{\beta \vDash n} \frac{1}{\ell(\beta)}
%\sum_{k=1}^{\ell(\beta)} \beta_{1} a_{\mathsf{cyc}^{k}(\beta)}
%= \sum_{\beta \vDash n} \frac{1}{\ell(\beta)}
%\sum_{k=1}^{\ell(\beta)} \mathsf{cyc}^{-k}(\beta)_{1} a_{\beta}
%= \sum_{\beta \vDash n} \frac{n a_{\beta}}{\ell(\beta)}~.
%\]
%We will show that 
%\begin{equation}
%\label{eq:LyndonMobius}
%\sum_{\beta \vDash n} \frac{n a_{\beta}}{\ell(\beta)} = |I_{n}| = \sum_{d | n} d \; |\{\text{degree $d$ Lyndon words in $X$}\}|,
%\end{equation}
%from which M\"{o}bius inversion shows that the number of degree $n$ Lyndon words is equal to the formula for $p_{n}$ in terms of $\vec{a}$ given in Proposition~\ref{prop:sequences} (iii).
%
%To start, we define a ``faux-cycling'' operation on $I_{n}$ by
%\[
%\mathsf{fcyc}(i, w) = \begin{cases} 
%\big(i+1, w\big) & \text{if $i < \mathsf{deg}(w_{1})$} \\ 
%\big(1, \mathsf{cyc}(w)\big) & \text{otherwise}.
%\end{cases}
%\]
%For any degree $n$ word $w = w_{1} w_{2} \cdots w_{\ell}$ and  $1 \le a \le \ell$, 
%\[
%(0, \mathsf{cyc}^{a}(w)) = \mathsf{fcyc}^{\mathsf{deg}(w_{1}) + \cdots + \mathsf{deg}(w_{a-1})} (0, w).
%\]
%Thus, $\mathsf{fcyc}$ is periodic of order $n$.  Moreover, if $k$ is the minimal positive integer for which $\mathsf{cyc}^{k}(w) = w$, then the $\mathsf{fcyc}$ orbit of $(0, w)$, or $(i, w)$ for any $1 \le i \le \mathsf{deg}(w_{1})$, has size
%\[
%d = \mathsf{deg}(w_{1}w_{2}\cdots w_{k}).
%\]
%Finally, the cyclic shifts of $w' = w_{1}w_{2}\cdots w_{k}$ are distinct, so taking the unique minimal one, we obtain a Lyndon word of degree $d$.  Since $w$ is the $(\ell/k$)-fold concatenation of $w'$ with itself, the $d$-elements of the $\mathsf{fcyc}$-orbit of $(0, w)$ are uniquely determined by $w'$.
%\end{proof}

\begin{example}\label{ex:balancedLyndon}
For specific examples of sequences,
$\vec{p}$ may have better-known interpretations
than the one given in  Proposition~\ref{prop:combinatorialinterpretation}.
Continuing with Example \ref{ex:catalan}, we have that if
$h_n = a_{n+1} = \frac{1}{n+1}\binom{2n}{n}$, Proposition
\ref{prop:combinatorialinterpretation} says that $p_n$ is equal to the number
of Lyndon words in an alphabet $X = \biguplus_{n\geq1} X^{(n)}$ with $a_n = |X^{(n)}|$.
However,~\cite[\href{https://oeis.org/A022553}{A022553}]{OEIS} states that $p_n$ is also equal to the number of
length $2n$ Lyndon words in the alphabet $\{0 < 1\}$ with an equal number of $0$s and $1$s.
\end{example}

\begin{corollary}
If $\vec{a} \in \NN^{\ZZ_+}$, then $\vec{h} \geq \vec{p} \geq \vec{a} \geq \vec{0}$.
\end{corollary}
\begin{proof}
Let $X = \biguplus_{n \ge 1} X^{(n)}$ be a graded set with $|X^{(n)}| = a_{n}$.  
Considered as a word with one letter, each element $x \in X$ is a Lyndon word, so by Proposition~\ref{prop:combinatorialinterpretation} the inequalities above correspond to the set inclusions
\[
\{\text{degree $n$ words in $X$}\} 
\supseteq \{\text{degree $n$ Lyndon words in $X$}\} 
\supseteq X^{(n)}. \qedhere
\]
%We have that for each $i \geq 1$ and each $x \in X^{(i)}$ is a Lyndon word, hence $a_i \leq p_i$.
%Moreover each Lyndon word of degree $i$ is itself a word of degree $i$, so $h_i \geq p_i$.
\end{proof}

\begin{comment}
A \defn{set partition} $A$ of a finite set $X$ is a set of sets $A = \{ A_1, A_2, \ldots, A_k \}$ where $A_i \subseteq X$,
$A_i \cap A_j = \emptyset$ if $i \neq j$ and $\cup_{i=1}^k A_i = X$.  The sets $A_i$ are known as the \defn{parts}
of the set partition.  We indicate that $A$ is a set partition of
$[n] := \{1,2, \ldots, n\}$ by the notation $A \vdash [n]$ and the \defn{length} of the
set partition $A$ is $k$ and is denoted $\ell(A)$.

A set partition $A$ is called \defn{crossing} if there exists $A_i \neq A_j$ which
are parts of $A$ with $a < b < c < d$ and $a,c \in A_i$ and $b,d \in A_j$.  A set partition is said to be \defn{noncrossing} otherwise.
A set partition $A$ is said to be \defn{nesting} if there exists $A_i \neq A_j$ which
are parts of $A$ with $a < b < c < d$ and $a,d \in A_i$ and $b,c \in A_j$ and is \defn{nonnesting} otherwise.
\mike{The definition of nonnesting is probably not correct}

We will define a few combinatorial operations on set partitions that we will need to describe the algebra structure.
For $A \vdash [n]$ and $k \in \mathbb{Z}_{\geq 0}$, let $A_{\uparrow k}$ be the set partition
$\{ \{ a + k : a \in A_i \} : 1 \leq i \leq \ell(A) \}$.  If $A \vdash [n]$ is not equal to $B \cup C_{\uparrow k}$
for some set partitions $B \vdash [k]$ and $C \vdash [n-k]$ with $0 < k < n$, then we say that
$A$ is \defn{atomic}.

The algebra of symmetric functions in noncommuting variables was first considered by Wolf \cite{W36}
and much later in a more combinatorial setting by Rosas and Sagan \cite{RS06}.
We will define $\mathsf{NCSym}$ by its Hopf algebra structure as the linear span of set partitions.
We define the finite dimensional vector space
$\mathsf{NCSym}_n = \mathrm{span}_{\mathbb C}\{ \mathbf{h}_A : A \vdash [n] \}$
and set $\mathsf{NCSym} := \bigoplus_{n \geq 0} \mathsf{NCSym}_n$.

The product on $\mathsf{NCSym}$ is defined on the basis elements and extended linearly.
Let $A \vdash [k]$ and $B \vdash [n]$, then
$$\mathbf{h}_A \cdot \mathbf{h}_B = \mathbf{h}_{A \cup B_{\uparrow k}}~.$$

The coproduct on the Hopf algebra $\mathsf{NCSym}$ appears in \cite{B08}
and is equal to
$$\Delta(\mathbf{h}_A) = \sum_{A \subseteq [n]}
\mathbf{h}_{\mathrm{st}(A|_S)} \otimes \mathbf{h}_{\mathrm{st}(A|_{S^c})}~.$$
\mike{notation to be defined above: $A|_S$, $\mathrm{st}(A)$}
\end{comment}

\section{Sequences and Tensor algebras}
\label{sec:HopfAlgebra}

We now give the algebraic context for the results of Section~\ref{sec:SequencePrelims}.  
As in the introduction, we use the abbreviation \FGCCHA to mean \textsf{F}ree \textsf{G}raded \textsf{C}onnected \textsf{C}ocommutative \textsf{H}opf \textsf{A}lgebra, which we now formally define.

We first recall the tensor algebra of a graded vector space $V = \bigoplus_{n \ge 1} V_{i}$:
\begin{equation}
\label{eq:tensoralg}
\mathsf{T}(V) = \bigoplus_{n \ge 0} \Big( \bigoplus_{k \ge 0} V_{k} \Big)^{\otimes n},
\end{equation}
with a graded multiplication given by $\otimes$, where elements of $V_{k}$ have degree $k$.  

\begin{definition}
\label{def:FGCCHA}
An \FGCCHA is a graded cocommutative Hopf algebra $H$ which is freely generated by some graded subset $X = \biguplus_{n \ge 1} X^{(n)}$ of $H$, so that \textit{as algebras}
\[
H \cong \mathsf{T}(\CC X) 
\qquad\text{where}\qquad
\CC X = \bigoplus_{k \ge 0} \CC\operatorname{-span}\{x \in X^{(k)}\}.
\]
Under this isomorphism, the coproduct of $H$ corresponds to some graded algebra homomorphism $\tilde{\Delta}: \mathsf{T}(\CC X) \to \mathsf{T}(\CC X) \otimes \mathsf{T}(\CC X)$.
\end{definition}

We will also consider Lie subalgebras of $\mathsf{T}(V)$, and more generally any \FGCCHA, under the commutator bracket $[x, y] = xy - yx$.

\begin{definition}[{see~\cite[\S 0.2]{Reutenauer-FreeLieAlgebras}}]
\label{defn:freelie}
The free Lie algebra $\mathfrak{L}(X)$ on a graded set $X = \biguplus_{n\ge 1} X^{(n)}$ is the smallest graded subspace of $\mathsf{T}(\CC X)$ that contains $X$ and is closed under the commutator bracket.  
This is a Lie algebra under the commutator bracket, but not a Hopf algebra.
\end{definition}

Given any \FGCCHA $H$, the primitive elements of $H$ are elements of the graded subspace
\[
\mathcal{P}(H) = \{x \in H \;|\; \Delta(x) = x \otimes 1 + 1 \otimes x\}.
\]
To be clear, the generating set $X$ may not be contained in $\mathcal{P}(H)$.  
The bracket operation $[x,y] = xy - yx$ makes $\mathcal{P}(H)$ into a Lie algebra.  
%However it is not the case that $\mathcal{P}(H)$ maps to $\mathfrak{L}(X)$ under the isomorphism in Definition~\ref{def:FGCCHA}, as the generating set $X$ need not be primitive in $H$.  \lucas{TODO: is this clear?}

Given a graded Lie algebra $L$, the (graded) derived subalgebra of $L$ is 
\begin{equation}
\label{eq:derivedLiesubalgebra}
[L, L] = \bigoplus_{n \ge 1} [L, L]_{n}
\qquad\text{where}\qquad
[L, L]_{n} = \CC\operatorname{-span}\{\text{degree-$n$ commutators of $L$}\}.
\end{equation}

The main result of this section relates the graded dimensions of an \FGCCHA to its generating set and primitives.
This result follows from a standard analysis which appears in the literature without being stated
as a numbered result (see for example \cite{AL15} Section 4.2).

\begin{proposition}
\label{prop:SequencesAsHopfStructures}
Let $H$ be a \FGCCHA with generating set $X$.  The triple of sequences
\[
\left(\vecdim(H), \,
\veccard(X),\,
\vecdim\left(\mathcal{P}(H)\right) \right)
\]
satisfies Equation~\eqref{eq:gf_relation}.
\end{proposition}


For the sake of completeness we prove Proposition~\ref{prop:SequencesAsHopfStructures} at the end of the section.  
We will use of the Cartier-Milnor-Moore and Poincare--Birkhoff--Witt theorems, stated below.  
First, however,  we give an example to illustrate the result.  

\begin{example}[Noncommutative symmetric functions]
\label{ex:NSym}
Following~\cite{GKLLRT}, let $\mathsf{NSym}$ be the cocommutative Hopf algebra freely generated by $X = \{ \mathbf{h}_1, \mathbf{h}_2, \mathbf{h}_3, \ldots \}$, with grading given by $\mathsf{deg}(\mathbf{h}_{i}) = i$ for all $i \ge 1$ so that $\veccard(X) = (1, 1, 1, \ldots)$.  
%The Hopf algebra $\mathsf{NSym}$ is the graded dual of the Hopf algebra to the quasisymmetric functions $\mathsf{QSym}$.
The bases of the degree $n$ homogeneous components of $\mathsf{NSym}$ are indexed by compositions
of $n$ and hence $\vecdim(\mathsf{NSym}) = (1,2,4,8,\ldots)$.
The dimensions of the space of primitives is the sequence 
$\vecdim(\mathcal{P}(\mathsf{NSym})) = (1, 1, 2, 3, 6, 9, 18, 30, 56, \ldots)$
whose $n^{th}$ term is equal to the number
of compositions of $n$ that are Lyndon \cite{H07}.
\end{example}

%We now begin to assemble our proof of Proposition~\ref{prop:SequencesAsHopfStructures}.
%As stated above, this is a folklore result which we prove using well-known theorems for the sake of completeness.

Given a graded Lie algebra $L = \bigoplus_{n \ge 1} L^{(n)}$, let the \emph{universal enveloping algebra} of $L$ be
\[
\mathcal{U}(L) = \mathsf{T}(L) \big/ \big\langle x\otimes y - y \otimes x - [x, y] \;|\; \text{$x, y \in L$} \big\rangle.
\]
This is a cocommutative Hopf algebra where the coproduct on $\mathcal{U}(L)$ is defined so that every element of $L$ is primitive.  By \cite[Theorem 1.4]{Reutenauer-FreeLieAlgebras} we have $\mathcal{P}(\mathcal{U}(L))=L$.  

The relationship between $\mathcal{U}(L)$ and $\mathcal{P}$ is further determined by the Poincar\'{e}--Birkhoff--Witt Theorem and the Poincar\'{e}--Birkhoff--Witt Theorem.  We state each as they appear in~\cite[Theorem 4.1.3]{L08}, but we refer the reader to~\cite[{\color{red} missing ref!}]{Cartier57} and~\cite[Theorem 5.18]{MM65} for original statements.

Given any ordered homogeneous basis $\{z_i\}$ of $L$, the Poincar\'{e}--Birkhoff--Witt Theorem
states for that the enveloping algebra $\mathcal{U}(L)$ has a homogeneous basis
\[
\{ z_{i_1}z_{i_2}\cdots z_{i_k} \;|\; i_1 \leq i_2 \leq \cdots \leq i_k\}.
\]
This statement carries important information about the dimension of $\mathcal{U}(L)$, namely that 
\[
\vecdim(\mathcal{U}(L))_{n}= \#\{\text{multisubsets $S$ of $\{z_{i}\}$} \;|\; \sum_{z \in S} m_{z}(S) \mathsf{deg}(z) = n\},
\]
where $m_{z}(S)$ denotes the multiplicity of $z$ in $S$.

For any \FGCCHA $H$, the space $\mathcal{P}(H)$ is a Lie algebra under the bracket $[x, y] = xy - yx$.  
The Cartier-Milnor-Moore theorem states there is a Hopf algebra isomorphism
\[
\begin{array}{rcl}
\mathcal{U}(\mathcal{P}(H)) &\to& H \\
\mathcal{P}(H) \ni x & \mapsto&  x.
\end{array}
\]

\begin{proof}[Proof of Proposition~\ref{prop:SequencesAsHopfStructures}]
Let $\vec{h} = \vecdim(H)$, $\vec{a} = \veccard(X)$, and $\vec{p} = \vecdim(\mathcal{P}(H))$.  We will show that $\vec{h} = \phi_{a, h}(\vec{a})$ and $\vec{p} = \phi_{h, p}(\vec{h})$, from which the claim follows.  

For $n \ge 1$, $h_{n}$ is the number of degree $n$ monomials in $X$, which is also the number of degree $n$ words in $X$.  
Applying Proposition~\ref{prop:combinatorialinterpretation}, $\vec{h} = \phi_{a, h}(\vec{a})$.

On the other hand, the Milnor--Moore theorem states that $H$ is
isomorphic to the universal enveloping algebra of $\mathcal{P}(H)$.
By the Poincare--Birkhoff--Witt theorem, for any fixed homogeneous basis
$Y = \biguplus_{n \ge 0} Y^{(n)}$ of $\mathcal{P}(H)$, $h_{n}$ counts
the multisets of $Y$ whose elements have degree summing (with repetition)
to $n$.  Since $|Y^{(n)}| = p_{n}$ for all $n \ge 1$, the number of these
multisets is exactly
\[
\sum_{\lambda \vdash n} \prod_{d \geq 1} \binom{p_d + m_d(\lambda) -1}{m_d(\lambda)},
\]
so by Proposition~\ref{prop:sequences} we have $\vec{p} = \phi_{h, p}(\vec{h})$.
\end{proof}

%\subsection{Free algebras}
%\label{sec:freealgebras}
%
%In this section we define the free algebra on a graded set and state its universal property.  
%Let $X$ be a graded set, 
%\[
%X = \biguplus_{n \ge 1} X_{n}.
%\]
%The free graded algebra on the set $X$ is\mike{what are the $g_x$?}
%\[
%\mathcal{F}(X) = \bigoplus_{n \ge 0} \bigoplus_{\alpha \vDash n} 
%\CC\operatorname{-span}\{g_{x_{i_{1}} }g_{x_{i_{2}}} \cdots g_{x_{i_{\ell}}} \;|\; x_{i_{k}} \in X_{\alpha_{k}}\},
%\]
%where the degree zero component is $\CC 1_{\mathcal{F}(X)}$.  This algebra $\mathcal{F}(X)$
%has the following \emph{universal property}\mike{reference?}:
%
%\begin{property}
%\label{prop:universalfree}
%Let $A = \bigoplus_{n \ge 0} A_{i}$ be a graded algebra.  For every function $\phi: X \to A$ such that $\phi(X_{i}) \subseteq A_{i}$, there exists a unique graded algebra homomorphism $\tilde{\phi}: \mathcal{F}(X) \to A$ such that $\tilde{\phi}|_{X} = \phi$, i.e.
%\[
%    \begin{tikzpicture}
%        \node at (0, 0) (X) {$X$};
%        \node at (3, 0) (F) {$A$};
%        \node at (0, -1) (A) {$\mathcal{F}(X)$};
%        \draw[->] (X) -- node[above] {$\phi$} (F);
%        \draw[->] (X) -- node[left] {inclusion} (A);
%        \draw[->, dashed] (A) -- node[below right] {$\tilde{\phi}$} (F);
%        \end{tikzpicture}.
%\]
%\end{property}
%
%
%\begin{proposition}
%\label{prop: free algebra hilbert series}
%Given a sequence $\vec{a} = (a_{1}, a_{2}, \ldots)$ of nonnegative integers, let $X$ be a graded set with $|X_{i}| = a_{i}$, and consider the free algebra $\mathcal{F}(X)$.  Then the Hilbert series for $\mathcal{F}(X)$ is
%\[
%\mathrm{Hilb}(\mathcal{F}(X); t) =  \frac{1}{1 - a_{1}t - a_{2}t^{2} - a_{3}t^{3} - \cdots}.
%\]
%%
%%
%%
%%Given a sequence $\vec{a} = (a_{1}, a_{2}, \ldots)$ of nonnegative integers, let $\mathfrak{L}(\vec{a})$ denote the free, graded Lie algebra with $a_{i}$ generators in degree $i$, and zero generators in degree zero.  The universal enveloping algebra
%%\[
%%\mathcal{U}\big(\mathfrak{L}(\vec{a})\big)
%%\]
%%
%%\begin{enumerate}
%%
%%\item is a free, cocommutative, graded, connected Hopf algebra.
%%
%%\item has Hilbert series
%%
%%\[
%%f(t)=\frac{1}{1 - a_{1}t - a_{2}t^{2} - a_{3}t^{3} - \cdots}.
%%\]
%%
%%\end{enumerate}
%\end{proposition}
%
%\begin{proof}
%%
%%\begin{enumerate}
%%
%%    \item From Jacobson \cite[more specific reference]{jacobson2013lie}\lucas{This is now proved in section~\ref{sec:envelopingalgebras}, we should refer to this or remove this claim entirely.}
%%
%%    \item 
%    Expand the following generating function as a geometric series, we have 
%
%    $${\begin{split}
%        \frac{1}{1 - a_{1}t - a_{2}t^{2} - a_{3}t^{3} - \cdots} &= \sum_{n=0}^\infty (a_1t+a_2t^2+\cdots)^n~.
%    \end{split}}$$
%
%    Expanding this sum we have the following equality
%
%    $$\frac{1}{1 - a_{1}t - a_{2}t^{2} - a_{3}t^{3} - \cdots}
%    =\sum_{n=0}^\infty \left(\sum_ {\beta \vDash n} a_\beta \right) t^n.$$
%
%    Given $\Vec{a} = (a_{1}, a_{2}, \ldots)$, we can consider that $\mathfrak{L}(\Vec{a})$\mike{what is $\mathfrak{L}(\Vec{a})$?  Should this be
%    $\mathcal{F}(X)$?}
%is generated by the set
%    $$X=\biguplus_{i \geq 1}\{x_{(i,j)}: 1 \leq j \leq a_i\}$$
%     where for each $j$, $x_{(i,j)}$ is a generator of degree $i$.\mike{what do we mean ``is a generator''? of what?}
%
%From ~\cite[Theorem 7 (Witt)]{jacobson2013lie} we have that a basis for the graded components $\mathcal{U}\big(\mathfrak{L}(\vec{a})\big)_n$ is the set of monomials of the form $m=x_{(\beta_1,j_1)} \cdots x_{(\beta_\ell,j_\ell)}$ where
%     for each $d$, $1 \leq j_d \leq a_{\beta_{d}}$ with $\beta=(\beta_1,\dots,\beta_\ell)$ is a composition of $n$.
%By counting the number of monomials of degree $n$,
%we conclude that the dimension of each graded component of $\mathcal{F}(X)$
%is given by $\sum_ {\beta \models n} a_\beta$
%which is the coefficient of $t^n$ in the generating function.
%%\end{enumerate}
%
%\end{proof}
%
%\subsection{Universal Enveloping Algebras}
%\label{sec:envelopingalgebras}
%
%Let $L$ be a graded Lie algebra with bracket $[\cdot, \cdot]$.  The universal enveloping algebra is the graded associative algebra on the space
%\[
%\mathcal{U}(L) = \bigoplus_{n \ge 0} \bigoplus_{\alpha \vDash n} L_{\alpha_{1}} \otimes L_{\alpha_{2}} \otimes \cdots \otimes L_{\alpha_{\ell}},
%\]
%where the degree zero component is $\CC 1_{\mathcal{U}(L)}$.
%Multiplication in $\mathcal{U}(L)$ is concatenation of tensors,
%subject to the relations of the form $a \otimes b - b \otimes a = [a, b]$
%for all $a, b \in L$.  This algebra $\mathcal{U}(L)$ has the following \emph{universal property}:\mike{reference?}
%
%\begin{property}
%\label{prop:universalLie}
%Let $A = \bigoplus_{n \ge 0} A_{i}$ be a graded algebra.  For every linear map $\psi: L \to A$ such that $\psi(L_{i}) \subseteq A_{i}$ and
%\[
%\psi([a, b]) = \psi(a)\psi(b) - \psi(b)\psi(a)
%\qquad\text{for all $a, b \in L$},
%\]
%there exists a unique graded algebra homomorphism $\tilde{\psi}: \mathcal{U}(L) \to A$ such that $\tilde{\psi}|_{L} = \psi$, i.e.
%\[
%    \begin{tikzpicture}
%        \node at (0, 0) (L) {$L$};
%        \node at (3, 0) (U) {$A$};
%        \node at (0, -1) (A) {$\mathcal{U}(L)$};
%        \draw[->] (X) -- node[above] {$\psi$} (U);
%        \draw[->] (X) -- node[left] {inclusion} (A);
%        \draw[->, dashed] (A) -- node[below right] {$\tilde{\psi}$} (U);
%        \end{tikzpicture}.
%\]
%\end{property}
%
%Given a graded set $X = \biguplus_{i \ge 1} X_{i}$, we also define the free Lie algebra on $X$ to be the graded Lie algebra
%\mike{what are the $h_x$?}
%\[
%\mathfrak{L}_{X} = \bigoplus_{n \ge 1} \bigoplus_{\alpha \vDash n} \CC\operatorname{-spanning}\{\text{brackets of $h_{x_{i_{1}}}, \ldots, h_{x_{i_{\ell}}}$} \;|\; x_{i_{k}} \in X_{\alpha_{k}} \},
%\]
%subject only to anticommutativity and the Jacobi identities.\mike{what are these relations?}
%
%%The following is quoted word for word from \cite{jacobson2013lie}. Lie algebras arise from associative algebras in a very simple way. Let $A$ be an associative algebra. If $x,y,\in A$, then we define the \textit{Lie product} or (additive) \textit{commutator} of $x$ and $y$ as
%%
%%$$[x,y]=xy-yx.$$
%%
%%One checks immediately that
%%
%%$$\begin{matrix}
%%    [x_1+x_2,y]=[x_1,y]+[x_2,y], \\
%%    [x,y_1+y_2]=[x,y_1]+[x,y_2],\\
%%    \alpha[x,y]=[\alpha x,y]=[x,\alpha y].
%%\end{matrix}$$
%%
%%Thus the products $[x,y]$ satisfies all the conditions on the product in a Lie algebra. The Lie algebra obtained in this way is called \textit{the Lie algebra} of the associative algebra $\mathfrak{U}$. We shall denote this Lie algebra as $\mathfrak{U}_L$.
%
%\begin{thm}[Theorem $7$ (Witt),\cite{jacobson2013lie}]
%Let $X$ be an arbitrary graded set.  Then
%\[
%\mathcal{U}(\mathfrak{L}_{X}) \cong \mathcal{F}(X).
%\]
%\label{thm: free UEA}
%%
%%Let
%%
%%
%%Let $X$ be an aribtrary set and let $\mathcal{F}$ denote the free algebra (freely) generated by $X$. Let $\mathfrak{F}^{\mathfrak{L}}$ denote the subalgebra of $\mathfrak{F}_L$ generated by the elements of $X$. Then $\mathfrak{F}^{\mathfrak{L}}$ is a free Lie algebra generated by $X$ and $\mathfrak{F}$ is the universal enveloping algebra of $\mathfrak{F}^{\mathfrak{L}}$. 
%\end{thm}
%\begin{proof}
%    Let \(X = \biguplus_{n \ge 1} X_{n}\) be a graded set and let \(\mathcal{F}(X)\) be the free algebra generated by \(X\). Also, let \( \mathcal{U} (\mathfrak{L}_{X})\) be the Universal Enveloping algebra of the free Lie algebra generated by \(X\). 
%    Define the map 
%    \begin{align*}
%        \begin{array}{rcl}
%            \phi :  X \longrightarrow & \mathcal{U} (\mathfrak{L}_{X}) \\
%             x  \longmapsto  & h_x \\ 
%        \end{array}
%    \end{align*}
%    where \(h_x =  h_{x_{i_{1}} }h_{x_{i_{2}} }\cdots h_{x_{i_{k}} } \in \mathcal{U} (\mathfrak{L}_{X})\) is the product of formal generators in \(X\). 
%    By Property~\ref{prop:universalfree} we have the unique graded homomorphism 
%    \begin{align*}
%        \begin{array}{rcl}
%            \tilde{\phi}: \mathcal{F}(X) \longrightarrow & \mathcal{U} (\mathfrak{L}_{X}) \\
%            g_x \longmapsto & h_x
%        \end{array}
%    \end{align*}
%    where \(g_x = g_{x_{i_{1}} }g_{x_{i_{2}} }\cdots g_{x_{i_{\ell}} } \in \mathcal{F}(X)\) is also the product of formal generators in \(X\). Similarly, 
%    define 
%    \begin{align*}
%        \begin{array}{rcl}
%            \psi :  \mathfrak{L}_{X} \longrightarrow &\mathcal{F}(X) \\
%        x  \longmapsto  & g_x .\\
%        \end{array}
%    \end{align*}
%    From Property~\ref{prop:universalLie} we obtain another unique graded homomorphism 
%    \begin{align*}
%        \begin{array}{rcl}
%            \tilde{\psi}: \mathcal{U}(\mathfrak{L}_{X}) \longrightarrow & \mathcal{F} (X) \\
%            h_x \longmapsto & g_x.
%        \end{array}
%    \end{align*}
%    To see that \(\mathcal{U}(\mathfrak{L}_{X}) \cong \mathcal{F}(X)\), notice that
%    \begin{align*}
%        \tilde{\phi}(\tilde{\psi}(h_{x_{i_{1}} }h_{x_{i_{2}}} \cdots h_{x_{i_{k}}}))  
%        &= \tilde{\phi}(\tilde{\psi}(h_{x_{i_{1}} })\tilde{\phi}(\tilde{\psi}(h_{x_{i_{2}} } )\cdots \tilde{\phi}(\tilde{\psi}(h_{x_{i_{k}} })) \\
%        &=  \tilde{\phi}(g_{x_{i_{1}} })\tilde{\phi}(g_{x_{i_{2}} })\cdots \tilde{\phi}(g_{x_{i_{\ell}} })\\
%        &= h_{x_{i_{1}} }h_{x_{i_{2}} } \cdots h_{x_{i_{k}} }
%    \end{align*} 
%    Similarly, it can also be shown that \(\tilde{\psi} \circ \tilde{\phi} (g_x) = g_x\) and as such \(\tilde{\phi} \circ \tilde{\psi} = \tilde{\psi} \circ \tilde{\phi} = id\).
%    Therefore, since \(\tilde{\phi}\) and \(\tilde{\psi}\) are inverses of each other,  \(\mathcal{U}(\mathfrak{L}_{X}) \cong \mathcal{F}(X)\).
%\end{proof}

%Let $\Phi$ be a field. For the sake of simplcity we shall now restrict our attention to the case of a finite set set $X=\{x_1,x_2,\cdots,x_r\}$. Then
%define
%$$\mathfrak{M}:=\Phi x_1 \oplus \Phi x_2 \oplus \cdots \oplus \Phi x_r$$
%
%and $\mathfrak{F}= \Phi 1 \oplus \mathfrak{M} \oplus (\mathfrak{M} \otimes \mathfrak{M}) \oplus \cdots$, and we write $\mathfrak{F}=\Phi\{x_1,\ldots,x_r\}$. The algebra $\mathfrak{F}$ is graded with $\mathfrak{M}_m=\mathfrak{M}\otimes\mathfrak{M}\otimes\cdots \otimes \mathfrak{M}$ ($m$-times) as the space of the homogeneous elements of degree $m$. A basis for this space is the set of monomials of the form $x_{i_1}x_{i_2}\cdots x_{i_m}$, $i_j=1,2,\cdots,r$; hence $\dim \mathfrak{M}_m=r^m$.

\section{Characterization of \FGCCHAs by graded dimension}
\label{sec:isoclassification}

This section gives a classification of isomorphism types of \FGCCHAs via the associated integer sequences.  
This begins with Aliniaeifard and Thiem's result.

\begin{theorem}[{\cite[Theorem 12]{AT22}}]
\label{thm:AT}
Let $H$ and $K$ be \FGCCHAs.  Then $H \cong K$ if and only if $\vecdim(H) = \vecdim(K)$.
\end{theorem}

The result is deduced from standard properties found in~\cite[Section 4.1]{L08}, and similar results appear elsewhere in the literature, see e.g.~\cite[Prop.~1.4]{AS05cc}, so we omit a proof.  We demonstrate the utility of this result in Example~\ref{example:hopf_algebras_of_permutations}.

%This result may not be surprising to experts in the field.  
%However, we have not found it recorded elsewhere in the literature, and by stating it the authors of~\cite{AT22} generalize a recurrent approach to comparing Hopf algebras; see Example~\ref{example:hopf_algebras_of_permutations}.
%% by doing so~\cite{AT22} 
%\lucas{Consider rewording}{\color{red} With discussions with people who work in Hopf algebra we've come to the conclusion that this result may have been known implicitly prior to Aliniaeifard and Thiem's publication.  However, given the way results are stated in the literature, it does not seem to be used explicitly; see Example~\ref{example:hopf_algebras_of_permutations}.}

We consider here the question of determining which sequences $\vec{h} \in \NN^{\ZZ_+}$
appear as the graded dimension of an \FGCCHA.  In fact,
we go further by identifying an explicit representative of each isomorphism class of \FGCCHA.  
Recall the free graded Lie algebra from Definition~\ref{defn:freelie} and for each sequence $\vec{a} \in \NN^{\ZZ_{+}}$, let
\begin{equation}
\label{eq:La}
\mathfrak{L}(\vec{a}) = \mathfrak{L}(X_{\vec{a}}) \qquad\text{where}\qquad X_{\vec{a}} = \biguplus_{n \ge 1} \{x^{(n)}_{i} \;|\; 1 \le i \le a_{n}\}.
\end{equation}
Further recall the map $\phi_{h, a}$ from
Definition~\ref{defn:sequencetransfer} and the universal enveloping
algebra map $\mathcal{U}(-)$ defined in Section~\ref{sec:HopfAlgebra}.

\begin{theorem}
\label{thm:a sequence}
There is a bijection
\[
\begin{array}{rcl}
%\mathcal{U}(\mathfrak{L}(-)):
\left\{ \text{sequences }\vec{a} \in \NN^{\ZZ_+} \right\} & \to & \left\{ \begin{array}{c} \text{Isomorphism classes} \\ \text{of \FGCCHA} \end{array} \right\} \\[2ex]
\vec{a} & \mapsto & \mathcal{U}(\mathfrak{L}(\vec{a}))) \\
\phi_{h,a}(\vecdim(H)) & \mapsfrom & H
\end{array}.
\]
In particular, $\vec{h} \in \NN^{\ZZ_+}$ is the dimension sequence of an \FGCCHA $H$ if and only if $\phi_{h, a}(\vec{h}) \in \NN^{\ZZ_+}$.  
Similarly, $\vec{p} \in \NN^{\ZZ_{+}}$ is the dimension sequence for $\mathcal{P}(H)$ of an \FGCCHA $H$ if and only if $\phi_{p, a}(\vec{p}) \in \NN^{\ZZ_{+}}$.
\end{theorem}

We prove the theorem in Section~\ref{sec:classificationproof} following additional examples and results. 

\begin{example}[A cocommutative Hopf algebra on permutations]
\label{example:hopf_algebras_of_permutations}
    Let $\vec{h} = (n!)_{n \geq 1}$, so that $\vec{a} = \phi_{h,a}(\vec{h}) = (1,1,3,13,71,\ldots)$~\cite[\href{https://oeis.org/A003319}{A003319}]{OEIS}.  
    Then $\vec{a}$ counts graded cardinality of the set $\dot{\mathfrak{S}}$ of \emph{connected} permutations, i.e.~those which are not the shifted concatenation of two others~\cite{AS05}.  
    (In the literature these are sometimes called ``indecomposable'' or ``irreducible'' permutations).
    By Theorem~\ref{thm:a sequence} there exists a \textsf{FGCCHA}
    $\mathcal{U}(\mathfrak{L}(\dot{\mathfrak{S}}))$ of graded dimension $n!$.  
%    Viewing each permutation as a word in the alphabet $\ZZ_{+}$, the product is shifted
%    concatenation of permutations, and the coproduct is defined such that
%    every indecomposable permutation is primitive.
    
    There are numerous \FGCCHAs with graded dimension $n!$ in the literature that have superficially different presentations.  
    This includes the Hopf algebras of heap ordered trees and permutation in~\cite{GL09}, the dual of the associated graded of the Malvenuto--Reutenauer Hopf algebra of permutations~\cite{AS05cc}, the Hopf algebra of permutations $\mathbf{\mathfrak{S}Sym}$ defined in~\cite[\S 3]{HNT08}, and the Hopf algebra of permutations ($\mathbb{K}\mathfrak{S}$) from~\cite[\S 5]{Li15}.
    The papers~\cite{AS05cc, GL09, HNT08, Li15} construct explicit isomorphisms between these Hopf algebras, and indeed by Theorem~\ref{thm:AT}, they are all isomorphic to $\mathcal{U}(\mathfrak{L}(\dot{\mathfrak{S}}))$.
    \end{example}

\begin{example}
Many combinatorially interesting sequences correspond to \FGCCHAs, but it is not obvious when this is the case; we illustrate this by considering two closely-related sequences.
\begin{enumerate}
\item $(1,1,2,3,5,8,13,\ldots)$, the Fibonacci sequence

\item $(2,1,3,4,7,11,18,\ldots)$, the Lucas sequence
\end{enumerate}
Let us consider the Fibonacci sequence $\vec{f} = (1,1,2,3,5,8,13,\ldots)$
as if it could be the graded dimensions of some Hopf algebra.
We compute first that $\phi_{h,a}(\vec{f}) = (1,0,1,0,1,0,\ldots)$
and by Theorem \ref{thm:a sequence} conclude
that there is a Hopf algebra $H$ with a basis indexed by
compositions with only odd parts and with one generator at each odd degree.
This Hopf algebra $H$ has graded dimension equal to $\vecdim(H) = \vec{f}$.
This Hopf algebra is sometimes referred to as the peak algebra~\cite[\S 2]{Bergeron_2002}.

Next consider the Lucas sequence $\vec{\ell} = (2,1,3,4,7,11,18,\ldots)$
as if it could also be the graded dimensions of an \FGCCHA.  We compute that $\phi_{h,a}(\vec{\ell})$ and determine
that the sequence is alternating and begins $(2, -3, 7, -13,\ldots)$ and so we must conclude
that there does not exist a Hopf algebra with graded dimensions equal to $\vec{\ell}$.
\end{example}

The rest of the section concerns the technical question of explicitly realizing the Aliniaeifard--Thiem isomorphism in every possible way; this has further applications in later sections.  
We now know that every \FGCCHA is isomorphic to $\mathcal{U}(\mathfrak{L}(\vec{a}))$ for some $\vec{a} \in \NN^{\ZZ_{+}}$, so it is natural to ask how many isomorphisms there are between these two objects.  
We noticed that the isomorphisms between $\mathcal{U}(\mathfrak{L}(\vec{a}))$ and $H$ are in bijection with ordered sequences of generators, inspiring the following definition.

\begin{definition}
\label{def:OPG}
%\lucas{TODO: change the X and Y's in OPG to be a different letter}
%\lucas{Change notation to reflect symbols for OPG: $\vec{A}$ and $\vec{B}$}
For an \FGCCHA $H$, an \emph{ordered primitive generating set} is a sequence of tuples
\[
\vec{A} = \Big(\vec{A}^{(n)} = (\alpha_{1}^{(n)}, \alpha_{2}^{(n)}, \ldots, \alpha_{a_{n}}^{(n)})\Big)_{n = 1}^{\infty}
\qquad\text{with}\qquad
\begin{array}{l}
%\text{(1) $\vec{X}^{(n)} = (x_{1}^{(n)}, x_{2}^{(n)}, \ldots, x_{1}^{(n)})$} \\
\text{(1) each $\alpha_{i}^{(n)} \in \mathcal{P}(H)_{n}$ , and} \\
\text{(2) $H$ is freely generated by $\vec{A}$.}
\end{array}
\]
Let
\[
\OPG(H) = \left\{ \text{ordered primitive generating sets of $H$} \right\}.
\]
\end{definition}

The following theorem uses the set $\OPG(H)$ to quantify the number of isomorphisms  $\mathcal{U}(\mathfrak{L}(\vec{a})) \cong H$.
%The second main result of the section is the following.

\begin{theorem}
\label{thm:OPGmaps}
Let $H$ be an \FGCCHA with $\vec{h} = \vecdim(H)$.  Then writing $\vec{a} = \phi_{h, a}(\vec{h})$ and $\vec{p} = \phi_{h, p}(\vec{h})$, we have bijections
\[
\begin{array}{rcl}
\Gamma: \{\text{graded Hopf algebra isomorphisms $\mathcal{U}(\mathfrak{L}(\vec{a})) \to H$}\} & \to & \OPG(H) \\
\phi & \mapsto & \phi(X_{\vec{a}}) \\
\end{array}
\]
and %\lucas{Change $A^{(n)}$ to $M^{(n)}$, in light of notation change for $\OPG(H)$}
\[
\begin{array}{rcl}
\Xi: \OPG(H) &\to& \left\{ \begin{array}{c}
\text{Sequences $\big(M^{(n)} \in \mathrm{Mat}_{a_{n} \times p_{n}}(\CC)\big)_{n=1}^{\infty}$ } \\
\text{with $\det\big( (M^{(n)}_{i, j})_{1 \le i, j \le a_{n}} \big) \neq 0$ for $n \ge 1$}
\end{array}\right\}
\end{array}.
\]
\end{theorem}

The proof of Theorem~\ref{thm:OPGmaps} is given in Section~\ref{sec:OPGproof}.  
As we do not explicitly describe our bijection, the second part of Theorem~\ref{thm:OPGmaps} should be read as a statement about how ``big'' the set $\OPG(H)$ is.  
Realizing our bijection requires one to make a rather complicated choice of basis for $\mathcal{P}(H)$, which we explain fully in the proof.  
However, we can illustrate the bijection concretely with a small example.  

\begin{example}
\label{ex:OPG}
We construct the set $\OPG(H)$ for the \FGCCHA $H = \CC\langle x, y, z\rangle$ freely generated by two primitive generators $x$ and $y$ in degree one and one primitive generator $z$ in degree two.  
Thus, in the notation of Theorem~\ref{thm:OPGmaps}, we have $\vec{a} = (2, 1, 0, \ldots)$ and $\vec{p} = \phi_{a, p}(\vec{a}) = (2, 2, \ldots)$. 
The theorem then states that $\OPG(H)$ is determined by a choice of matrices
\[
M^{(1)} = \begin{bmatrix}
a & b \\
c & d
\end{bmatrix}
\text{with $ac-bd \neq 0$}
\qquad\text{and}\qquad
M^{(2)} = \begin{bmatrix}
e & f
\end{bmatrix}
\text{with $e \neq 0$}
\]
to the ordered primitive generator set
\[
\Big(\big(ax+by, cx+dy\big), \big(ez + f(xy-yx)\big), \emptyset, \ldots \Big) \in \OPG(H).
\]
\end{example}

\subsection{Proof of Theorem~\ref{thm:a sequence}}
\label{sec:classificationproof}

We will make use the following established results
about free Lie algebras from~\cite{Reutenauer-FreeLieAlgebras}.

\begin{proposition}[{\cite[Theorem 0.5]{Reutenauer-FreeLieAlgebras}}]
\label{prop:LieToFree}
For a sequence $\vec{a}$ of a nonnegative integers, the enveloping algebra $\mathcal{U}(\mathfrak{L}(\vec{a}))$ is an \FGCCHA which is generated in degree $n$ by the $a_{n}$-many primitive generators of $\mathfrak{L}(\vec{a})$.
\end{proposition}

We now prove Theorem~\ref{thm:a sequence}; recall Proposition~\ref{prop:SequencesAsHopfStructures}.

\begin{proof}[Proof of Theorem~\ref{thm:a sequence}]
Given a sequence $\vec{a} \in \NN^{\ZZ_+}$, Proposition~\ref{prop:LieToFree} states that
$\mathcal{U}(\mathfrak{L}(\vec{a}))$ is an \FGCCHA freely generated by a set with graded
cardinality $\vec{a}$, so the map which sends $\vec{a}$ to $\mathcal{U}(\mathfrak{L}(\vec{a}))$ is well defined.
Now consider the injectivity of this map.
By Proposition~\ref{prop:SequencesAsHopfStructures},
\[
\vecdim\big(\mathcal{U}(\mathfrak{L}(\vec{a}))\big) = \phi_{a, h}\big(\vec{a}),
\]
which by Aliniaeifard and Thiem's result (Theorem~\ref{thm:AT}) is an invariant of the isomorphism type.
The map $\phi_{a, h}$ is invertible and hence injective,
for any two sequences $\vec{a}, \vec{b}$ in the domain,
\[
\mathcal{U}(\mathfrak{L}(\vec{a})) \cong \mathcal{U}(\mathfrak{L}(\vec{b}))
\qquad\text{if and only if}\qquad
\vec{a} = \vec{b}.
\]

Finally for surjectivity, fix an isomorphism class of \FGCCHA, let $H$ be a representative of that class, and let $\vec{h} = \vecdim(H)$.
By Proposition~\ref{prop:SequencesAsHopfStructures},
$\vec{a} = \phi_{h, a}(\vec{h})$ is the graded cardinality of the free generating set
of $H$ and so
$\vec{a}$ belongs to the domain.  
Moreover, we claim that the image of $\vec{a}$ is in the isomorphism class with representative $H$.  
As we deduced in the previous paragraph, the dimension sequence of
$\mathcal{U}(\mathfrak{L}(\vec{a}))$ is $\phi_{a, h}\big(\vec{a})$, which by definition is the dimension sequence of $H$.  
Thus, Aliniaeifard and Thiem's result (Theorem~\ref{thm:AT})
implies that $H \cong \mathcal{U}(\mathfrak{L}(\phi_{h, a}(\vec{h})))$~.
\end{proof}


\subsection{Proof of Theorem~\ref{thm:OPGmaps}}
\label{sec:OPGproof}

We now consider the problem of explicitly constructing isomorphisms between \FGCCHAs via the set $\OPG(H)$ defined at the beginning of the section.  Our proofs in this section and the next will make use of the subspaces
\[
H_{+} = \bigoplus_{n \geq 1} H_n
\qquad\text{and}\qquad 
H^{2}_{+} = \mu(H_{+} \otimes H_{+}).
\]
The space $H^{2}_{+}$ is a graded subspace of $H$ with
\begin{equation}
\label{eq:Hplusdef}
(H^{2}_{+})_{n} = \bigoplus_{\substack{\alpha \vDash n \\ \alpha \neq (n)}}
H_{\alpha_{1}} H_{\alpha_{2}}\cdots H_{\alpha_{\ell}} \subseteq H_{n}.
\end{equation}
By definition (see the beginning of Section~\ref{sec:HopfAlgebra}), the degree $n$ generators of $H$ descend to a basis of $H_{n}/ (H^{2}_{+})_{n}$, and therefore for any graded generating set $\vec{A} = \biguplus_{n \ge 1} \vec{A}^{(n)}$ of $H$, 
\[
\dim(H_{n}/(H^{2}_{+})_{n}) = |\vec{A}^{(n)}|.
\]
We also use an additional relation between $H_{+}/H^{2}_{+}$ and generators of $H$ which appears in~\cite{F23}.

\begin{proposition}[{\cite[Proposition 2.2 and 2.4]{F23}}, \cite{P94}]
\label{prop:indecomposable generators}
If $H$ is a free graded connected algebra and $\vec{A} \subseteq H$ is a graded set with $H_{+} = \CC \vec{A} \oplus H_{+}^{2}$, then $\vec{A}$ freely generates $H$.  If moreover $H$ is a Hopf algebra, then $\mathcal{P}(H) = \CC \vec{A} \oplus [\mathcal{P}(H), \mathcal{P}(H)]$.
\end{proposition}

\begin{proof}[Proof of Theorem \ref{thm:OPGmaps}]
Let $\vec{a} = \phi_{h,a}(\vecdim(H))$ and $X_{\vec{a}}$ be an element of $\OPG(\mathcal{U}(\mathfrak{L}(\vec{a})))$.
We first consider the map 
\[
\begin{array}{rcl}
\Gamma: \{\text{graded Hopf algebra isomorphisms $\mathcal{U}(\mathfrak{L}(\vec{a})) \to H$}\} &\to& \OPG(H) \\
\phi & \mapsto & \phi(X_{\vec{a}}) \\
\end{array},
\]
where $\phi(X_{\vec{a}})$ is the  ordered set
\[
\phi(X_{\vec{a}}) = \biguplus_{n \ge 0} \big( \phi(x_{1}^{(n)}), \phi(x_{2}^{(n)}), \ldots, \phi(x_{a_{n}}^{(n)}) \big) \in \OPG(H).
\]
We show that $\Gamma$ is a bijection.  The first step is to observe that $\Gamma$
is well-defined: if $\phi: \mathcal{U}(\mathfrak{L}(\vec{a})) \to H$
is an isomorphism then the set $\phi(X_{\vec{a}})$ must freely generate $H$.
Moreover as $\phi$ is a graded isomorphism and $x_{i}^{(n)}$ is primitive
of degree $n$ for all $n \ge 1$ and $1 \le i \le a_{n}$, it follows that
$\phi(x_{i}^{(n)})$ is also primitive of degree $n$.
The injectivity of $\Gamma$ follows from the fact that any two algebra
morphisms which agree on a generating set must be equal.
For surjectivity, consider an arbitrary
$\vec{A} = \big((\alpha_{i}^{(n)})_{i=1}^{a_{n}}\big)_{n \ge 1} \in \OPG(H)$
and define $\phi_{\vec{A}}:\mathcal{U}(\mathfrak{L}(\vec{a})) \to H$ by
algebraically extending the mapping of generators $\phi_{\vec{A}}: x_{i}^{(n)} \mapsto \alpha_i^{(n)}$.
Then $\phi_{\vec{A}}$ is an isomorphism and $\phi_{\vec{A}}(X_{\vec{a}}) = \vec{A} \in \OPG(H)$.

We now define a bijection
\[
\begin{array}{rcl}
\Xi: \OPG(H) &\to& \left\{ \begin{array}{c}
\text{Sequences $\big(M^{(n)} \in \mathrm{Mat}_{a_{n} \times p_{n}}(\CC)\big)_{n=1}^{\infty}$ } \\
\text{with $\det\big( (M^{(n)}_{i, j})_{1 \le i, j \le a_{n}} \big) \neq 0$ for $n \ge 1$}
\end{array}\right\}
\end{array}.
\]
Our definition depends on a choice of $\vec{A} \in \OPG(H)$ and a homogeneous basis 
\[
\biguplus_{n \geq 1}\{v_1^{(n)},v_2^{(n)},\ldots,v_{p_n - a_n}^{(n)}\}
\]
of the derived subalgebra $[\mathcal{P}(H),\mathcal{P}(H)]$  (see Equation~\eqref{eq:derivedLiesubalgebra}), which we now fix.  
By Proposition~\ref{prop:indecomposable generators} $\mathcal{P}(H) = \CC \vec{A} \oplus [\mathcal{P}(H), \mathcal{P}(H)]$ so the set $\{\alpha_{1}^{(n)}, \ldots, \alpha_{a_{n}}^{(n)}, v_{1}^{(n)}, \ldots, v_{p_n - a_n}^{(n)}\}$ is a basis for the degree $n$ component of $\mathcal{P}(H)$.  
For any $\vec{B} = \big((\beta_{i}^{(n)})_{i=1}^{a_{n}}\big)_{n \ge 1} \in \OPG(H)$, we define $M^{(n)}$ to be the matrix whose rows express each $\beta_{i}^{(n)}$ in this basis, and set
\[
\Xi(\vec{B}) = (M^{(n)})_{n \ge 1}.
\]
The matrix $(M^{(n)}_{i, j})_{1 \le i, j \le a_{n}}$ gives the change of basis from $\vec{A}_{n}$ to $\vec{B}_{n}$ in the quotient $\mathcal{P}(H)_{n}/[\mathcal{P}(H),\mathcal{P}(H)]_{n}$.  Since this is invertible, it has a nonzero determinant.

%By \cite[Prop. 2.4]{F23}, $\mathcal{P}(H)$ is freely generated as a Lie algebra by $\vec{A}$, so that $\mathcal{P}(H)$ is isomorphic to the free Lie algebra $\mathfrak{L}(\vec{A})$ from Definition~\ref{defn:freelie}.  
%    Moreover, since $\mathfrak{L}(\vec{A}) = \CC \vec{A} \oplus [\mathfrak{L}(\vec{A}),\mathfrak{L}(\vec{A})]$, 
%    \[
%        \CC \vec{A} \cong \mathcal{P}(H)/[\mathcal{P}(H),\mathcal{P}(H)].
%    \]
%    We can then interpret an arbitrary choice of $\vec{S} \in \OPG(H)$ as some homogeneous change of basis of the quotient space $\mathcal{P}(H)/[\mathcal{P}(H),\mathcal{P}(H)]$ relative to $X$. \lucas{I'm not sure I see what this means.}
%    Each homogeneous component $\vec{S}^{(n)}$ then has the form
%    \[
%        \vec{S}^{(n)} = M^{(n)}_{0}\vec{A}^{(n)} + \vec{B}^{(n)},
%    \]
%    for some $M^{(n)}_{0} \in \GL(a_n,\CC)$ and $\vec{B}^{(n)} = \left(b_1^{(n)},b_2^{(n)},\ldots,b_{a_n}^{(n)}\right)$, for some $b_i^{(n)} \in [\mathcal{P}(H),\mathcal{P}(H)]_n$. 
%    
%    Let us fix . Then $\vec{B}^{(n)}$ can be identified with an $a_n$ by $p_n-a_n$ matrix $K^{(n)}$, such that $b_i^{(n)} = \sum_{j = 1}^{p_n - a_n}K_{ij}^{(n)}v_j^{(n)}$. Then we define the $a_n$ by $p_n$ matrix
%    \[
%    M^{(n)} = \Bigl[M^{(n)}_{0} \big| K^{(n)}\Bigr]
%    \]
%    as desired. 
%    
    On the other hand, given a sequence $\left(M^{(n)}\right)_{n \geq 1}$ with $M^{(n)} \in \textrm{Mat}_{a_n \times p_n}$ and
    \[\det\big( (M^{(n)}_{i, j})_{1 \le i, j \le a_{n}} \big) \neq 0,\] set
    \[
        \beta_i^{(n)} = \sum_{j = 1}^{a_n} M^{(n)}_{i, j}\alpha_{j}^{(n)} + \sum_{j = 1}^{p_n - a_{n}} M^{(n)}_{i, j+a_{n}}v_{j}^{(n)}.
    \]
    Then the ordered set
    \[
        \vec{B} = \biguplus_{n\geq 1} \left(\beta_1^{(n)},\beta_2^{(n)},\ldots,\beta_{a_n}^{(n)}\right)
    \]
    descends to a basis of $H_{+}/H_{+}^{2}$ and therefore generates $H$ by Proposition~\ref{prop:indecomposable generators}.  Since $\vec{B} \subseteq \mathcal{P}(H)$, $\vec{B} \in \OPG(H)$, and moreover $\Xi(\vec{B}) = (M^{(n)})_{n \ge 0}$.  Therefore we have constructed an inverse of $\Xi$, showing that it is a bijection.
%     and we see the correspondence between sequences
%     $\left(M^{(n)}\right)_{n \geq 1}$ and $\OPG(H)$ is surjective.
\end{proof}

%The above results prove the first part of Theorem \ref{thm:OPGmaps}. By definition of $\mathfrak{L}(\vec{a})$ we have that $A_n\in \GL(\CC)$ correspond to all isomorphism between two free Lie algebra $\mathfrak{L}(\vec{a})$ and $\mathfrak{L}(\vec{b})$ and by definition of $\vec{B}_n$ and $\mathcal{U}(-)$ we have that $\vec{Y}_n$ correspond to all isomorphism between two universal enveloping algebra. Therefore, the above proposition gives us part (i) of Theorem \ref{thm:OPGmaps}.

%\subsection{Passages that need a home}

%\lucas{we use the eulerian idempotent in the proof of Theorem~\ref{thm:surjection}, let's move it there}
%We will also make use of the \emph{Eulerian idempotent} (see \cite[\S 1.4]{AS05cc} or \cite[\S 4.5.2]{loday2013cyclic})
%%\cite[Section 1.4]{AL15},\cite{AS05cc} ,
%%\cite[\S 3]{GERSTENHABER1991263},\cite[\S 4.5.2]{loday2013cyclic},\cite[\S 3.2]{Reutenauer-FreeLieAlgebras}, )
%\begin{equation}
%\label{eq:eulerianidempotent}
%\mathbf{e}(x) = x - \frac{1}{2}\mu \circ \Delta_{+}(x) + \frac{1}{3} \mu^{(2)} \circ \Delta_{+}^{(2)}(x) - \cdots 
%\end{equation}
%where $\Delta_{+}$ denotes the positive coproduct, $\Delta_{+}(x) = \Delta(x) - x \otimes 1 - 1 \otimes x$,
%and we write $\mu^{(k)}$ and $\Delta^{(k)}$ for the $k^{th}$
%composition of the multiplication and comultiplication maps, respectively.
%By associativity and coassociativity of the Hopf algebra, these maps are well defined.
%
%Aguiar and Sottile use the Eulerian idempotent to produce primitive generators for the Grossman-Larson
%Hopf algebra of heap-ordered trees in~\cite{AS05cc},
%as do Novelli and Thibon for a Hopf algebra of dimension Catalan at each degree in~\cite[\S 5]{NT05}.
%Lauve and Mastnak use a related primitive idempotent to produce primitive generators for
%the symmetric functions in noncommuting variables in~\cite{LM11}.
%This method holds more generally for any \FGCCHA and was previously stated in the following result from \cite{PR04}.
%
%\begin{lemma}[{\cite[Lemma 22]{PR04}}]
%\label{lemma:primitive generators}
%Let $H$ be an \FGCCHA freely generated by a graded set $X = \biguplus_{n \geq 1} X_{n}$.  
%Then the graded set
%\[
%\mathbf{e}(X) = \biguplus_{n \ge 1} \{\mathbf{e}(x) \;|\; x \in X_{n}\}
%\]
%is a complete set of primitive generators of $H$.
%\end{lemma}
%%\eric{I found a paper which proves this exactly - Lemma 22 of Patras, Reutenauer - On Descent Algebras and Twisted Bialgebras \url{https://reutenauer.math.uqam.ca/wp-content/uploads/2024/05/Twisted-bialgebras-compresse.pdf} }
%%\begin{proof}
%%    For all $k \geq 2$ and $x \in X$, the term 
%%    \[
%%    \frac{(-1)}{k}^{k-1}\mu^{(k-1)} \circ \Delta_{+}^{(k-1)}(x)
%%    \]
%%    is in the space $H^{+2}$. Then we have
%%    \[
%%    \mathbf{e}(x) = x + \sum_{k \geq 2}\frac{(-1)}{k}^{k-1}\mu^{(k-1)} \circ \Delta_{+}^{(k-1)}(x),
%%    \]
%%    hence $\mathbf{e}(x) + H^{+2} = x + H^{+2}$. Because $X$ descends to a basis for $H^+/H^{+2}$, so must $\mathbf{e}(X)$, and by Proposition \ref{prop:indecomposable generators}, $\mathbf{e}(X)$ freely generates $H$.
%%\end{proof}



\section{Classifying surjections between \FGCCHAs}
\label{sec:surjection}
We now consider the problem of constructing surjective homomorphisms between two \FGCCHAs, $H$ and $K$, beginning with a naive approach to this problem.  
Let $\vec{A} \in \OPG(H)$ and $\vec{B} \in \OPG(K)$ be ordered primitive generating sets as in Definition~\ref{def:OPG}, and let $\vec{a} = \veccard(\vec{A})$ and $\vec{b} = \veccard(\vec{B})$. 
If $\vec{a} \ge \vec{b}$, projecting from $\vec{A}$ to $\vec{B}$ gives a surjective homomorphism:
\begin{equation}
\label{eq:defaultsurjection}
\begin{array}{rcl}
f^{\vec{A}}_{\vec{B}}: H & \to & K \\[1ex]
\alpha^{(n)}_{i} & \mapsto & \begin{cases}
\beta^{(n)}_{i} & \text{for $1 \le i \le b_{n}$} \\
0 & \text{otherwise}
\end{cases}
\end{array}
\end{equation}
where $\alpha^{(n)}_{i}$ and $\beta^{(n)}_{i}$ denote the
$i$th element of the degree $n$ parts of $\vec{A}$ and $\vec{B}$, respectively.  
We find that this construction actually accounts for all surjections between \FGCCHAs.

\begin{theorem}
\label{thm:surjection}
Let $H$ and $K$ be \FGCCHAs which are generated by sets of graded cardinality $\vec{a}$ and $\vec{b}$, respectively.  
\begin{enumerate}
\item There is a surjective homomorphism $f: H \to K$ if and only if $\vec{a} \ge \vec{b}$.

\item For every surjective homomorphism $f: H \to K$, there exists a (nonunique) choice of
ordered primitive generating sets $\vec{A} \in \OPG(H)$ and $\vec{B} \in \OPG(K)$
for which $f = f^{\vec{A}}_{\vec{B}}$.

\end{enumerate}
\end{theorem}

The proof of Theorem~\ref{thm:surjection} is given after Lemma~\ref{lemma:primitive generators}, following some intermediate examples and results.

\begin{example}
\label{ex:quotientHopf}
Recall the \FGCCHA from Example~\ref{ex:OPG}, $H = \CC\langle x, y, z \rangle$.
Also let $K = \CC\langle u, v \rangle$ denote an \FGCCHA
which is freely generated by two degree-one primitive elements $u$ and $v$. 
By Theorem \ref{thm:surjection} (1), since $(2,1,0,\ldots) \geq (2,0,0,\ldots)$,
there is at least one surjective homomorphism from $H$ to $K$.  
We define $f: H \to K$ by
\[
f(x) = u,
\qquad
f(y) = v,
\qquad\text{and}\qquad
f(z) = uv-vu,
\]
which does not obviously match the format of Equation~\eqref{eq:defaultsurjection}.  However, if we write $f$ using a slightly different set of ordered primitive generators,
\[
\vec{A} = \Big(\big( x, y\big), \big( z - xy + yx \big), \emptyset, \ldots \Big)
\qquad
\text{and}
\qquad
\vec{B} =  \Big(\big( u, v\big), \emptyset, \ldots \Big),
\]
then we have 
\[
f(x) = u,
\qquad
f(y) = v,
\qquad\text{and}\qquad
f(z - xy + yx) = 0,
\]
so we have found the $\vec{A}$ and $\vec{B}$ for which $f = f^{\vec{A}}_{\vec{B}}$ as predicted by the theorem.
\end{example}

\begin{corollary}
Given a surjective homomorphism $f: H \to K$ between two \FGCCHAs,
\begin{enumerate}
\item $K$ is isomorphic to a Hopf subalgebra of $H$.

\item Every other surjective homomorphism $g: H \to K$ has the form
$g = \gamma \circ f \circ \tau$ for some automorphims $\gamma$ of $K$ and $\tau$ of $H$.

\end{enumerate}
\end{corollary}
\begin{proof}
Let $f$ be a surjective homomorphism from $H$ to $K$.  
By Theorem~\ref{thm:surjection}, there exist $\vec{A}  = \big( ( \alpha_{i}^{(n)})_{i = 1}^{a_{n}} \big)_{n \ge 0} \in \OPG(H)$ and $\vec{B}   = \big( ( \beta_{i}^{(n)})_{i = 1}^{b_{n}} \big)_{n \ge 0}  \in \OPG(K)$ such that $f = f^{\vec{A}}_{\vec{B}}$.  To see (1), we observe that the homomophism $\kappa: K \to H$ defined by $\beta^{(n)}_{i} \mapsto \alpha^{(n)}_{i}$ is a left inverse of $f^{\vec{A}}_{\vec{B}}$.  Therefore $\kappa$ must be injective, so the Hopf subalgebra $\kappa(K) \subseteq H$ is isomorphic to $K$.

For (2), let $f$ be as in the previous paragraph  and let $g$ be a surjective homomorphism from $H$ to $K$.  
We first note that by Theorem~\ref{thm:surjection},  $g = f^{\vec{C}}_{\vec{D}}$ for some $\vec{C} \in \OPG(H)$ and $\vec{D} \in \OPG(K)$.  We then take $\tau: H \to H$ to be the extension of the order-preserving map which sends $\vec{C}$ to $\vec{A}$, and similarly $\gamma: K \to K$ as the extension of the order-preserving mapping of $\vec{B}$ to $\vec{D}$.  Then $g = \gamma \circ f \circ \tau$.
\end{proof}

Our proof makes use of the \emph{Eulerian idempotent}, also known as the canonical projection or the first Eulerian idempotent (see \cite{P94}, \cite[\S 1.4]{AS05cc} or \cite[\S 4.5.2]{loday2013cyclic})
%\cite[Section 1.4]{AL15},\cite{AS05cc} ,
%\cite[\S 3]{GERSTENHABER1991263},\cite[\S 4.5.2]{loday2013cyclic},\cite[\S 3.2]{Reutenauer-FreeLieAlgebras}, )
\begin{equation}
\label{eq:eulerianidempotent}
\mathbf{e}(x) = x - \frac{1}{2}\mu \circ \Delta_{+}(x) + \frac{1}{3} \mu^{(2)} \circ \Delta_{+}^{(2)}(x) - \cdots 
\end{equation}
where $\Delta_{+}$ denotes the positive coproduct, $\Delta_{+}(x) = \Delta(x) - x \otimes 1 - 1 \otimes x$,
and we write $\mu^{(k)}$ and $\Delta^{(k)}$ for the $k^{th}$
composition of the multiplication and comultiplication maps, respectively.
By associativity and coassociativity of the Hopf algebra, these maps are well defined.

When $H$ is graded, connected and cocommutative, the Eulerian idempotent projects onto $\mathcal{P}(H)$~\cite[Theorem 9.4]{S94}.
Following~\cite{P99}, we call the family of all graded linear idempotents of $H$ which project onto $\mathcal{P}(H)$ \emph{Lie idempotents}.

Aguiar and Sottile use the Eulerian idempotent to produce primitive generators for the Grossman-Larson
Hopf algebra of heap-ordered trees in~\cite{AS05cc},
as do Novelli and Thibon for a Hopf algebra of dimension Catalan at each degree in~\cite[\S 5]{NT05}.
Lauve and Mastnak use a related primitive idempotent to produce primitive generators for
the symmetric functions in noncommuting variables in~\cite{LM11}.  
Foissy and Patras recently showed that this method holds more generally for any \FGCCHA and Lie idempotent~\cite{FP24}, 
generalizing the following result of Patras and Reutenauer~\cite{PR04}.
%This method holds more generally for any \FGCCHA and was previously stated in the following result from \cite{PR04}.
%\lucas{Add something about Foissy's paper here!}

\begin{lemma}[{\cite[Lemma 22]{PR04}}]
\label{lemma:primitive generators}
Let $H$ be an \FGCCHA freely generated by a graded set $X = \biguplus_{n \geq 1} X_{n}$.  
Then the graded set
\[
\mathbf{e}(X) = \biguplus_{n \ge 1} \{\mathbf{e}(x) \;|\; x \in X_{n}\}
\]
is a complete set of primitive generators of $H$.
\end{lemma}
%\eric{I found a paper which proves this exactly - Lemma 22 of Patras, Reutenauer - On Descent Algebras and Twisted Bialgebras \url{https://reutenauer.math.uqam.ca/wp-content/uploads/2024/05/Twisted-bialgebras-compresse.pdf} }
%\begin{proof}
%    For all $k \geq 2$ and $x \in X$, the term 
%    \[
%    \frac{(-1)}{k}^{k-1}\mu^{(k-1)} \circ \Delta_{+}^{(k-1)}(x)
%    \]
%    is in the space $H^{+2}$. Then we have
%    \[
%    \mathbf{e}(x) = x + \sum_{k \geq 2}\frac{(-1)}{k}^{k-1}\mu^{(k-1)} \circ \Delta_{+}^{(k-1)}(x),
%    \]
%    hence $\mathbf{e}(x) + H^{+2} = x + H^{+2}$. Because $X$ descends to a basis for $H^+/H^{+2}$, so must $\mathbf{e}(X)$, and by Proposition \ref{prop:indecomposable generators}, $\mathbf{e}(X)$ freely generates $H$.
%\end{proof}

\begin{proof}[Proof of Theorem~\ref{thm:surjection}]
Let $H$ and $K$ be \FGCCHAs which are generated by sets of graded cardinality $\vec{a}$ and $\vec{b}$, respectively.  
If $\vec{a} \ge \vec{b}$, then Equation~\eqref{eq:defaultsurjection} defines a surjective homomorphism between $H$ and $K$, giving the ``if'' part of (1).

To prove the converse and (2), suppose that we have surjective homomorphism
\[
f: H \to K.
\]
For the next part of the argument, fix $n \ge 1$.  
Recall the subspaces $(H_{+}^{2})_{n} \subseteq H_{n}$ and $(K_{+}^{2})_{n} \subseteq K_{n}$ defined in Equation~\eqref{eq:Hplusdef}, and that 
\[
\dim(H_{n} / (H^{2}_{+})_{n}) = a_{n}
\qquad\text{and}\qquad
\dim(K_{n} / (K^{2}_{+})_{n}) = b_{n}.
\]
As $f$ is a graded surjective algebra homomorphism, it must map $H_{n}$ onto $K_{n}$ and $(H^{2}_{+})_{n}$ onto $(K^{2}_{+})_{n}$.  
Therefore $f$ induces a surjective linear transformation from $H_{n} / (H_{+}^{2})_{n}$ to $K_{n} / (K_{+}^{2})_{n}$.  
Surjectivity implies that $a_{n} = \dim(H_{n} / (H_{+}^{2})_{n}) \ge \dim(K_{n} / (K_{+}^{2})_{n})  = b_{n}$.

%Dimension considerations now give that $a_{n} \ge b_{n}$, so the ``only if'' part of (1) holds.  

We continue with our fixed $n$ for (2).  
First choose a tuple of elements $\big( y^{(n)}_{1}, \ldots, y^{(n)}_{b_{n}} \big)$ from $K_{n}$ which descend to a basis of $K_{n} / (K_{+}^{2})_{n}$.
Let $\beta_{i}^{(n)} = \mathsf{e}(y_{i}^{(n)})$ where $\mathsf{e}$ is the 
Eulerian idempotent. 
By Lemma~\ref{lemma:primitive generators} and Proposition~\ref{prop:indecomposable generators} the tuple $\big( \beta^{(n)}_{1}, \ldots, \beta^{(n)}_{b_{n}} \big)$ also descends to a basis of $K_{n} / (K^{2}_{+})_{n}$.  
Since $f$ induces a surjection $H_{n} / (H^{2}_{+})_{n} \to K_{n} / (K^{2}_{+})_{n}$, we may choose an ordered subset $\big( x^{(n)}_{1}, \ldots, x^{(n)}_{a_{n}} \big)$ of $H_{n}$ which descends to a basis of $H_{n}/(H^{2}_{+})_{n}$ and moreover has the property that
\[
f(x^{(n)}_{i}) = \begin{cases} \beta^{(n)}_{i} & \text{if $i \le b_{n}$} \\ 0 & \text{otherwise.} \end{cases}
\]
We can then take $\alpha_{i}^{(n)} = \mathsf{e}(x_{i}^{(n)})$, and as above the set $\big( \alpha^{(n)}_{1}, \ldots, \alpha^{(n)}_{a_{n}} \big)$ will still form a basis of $H_{n} / (H^{2}_{+})_{n}$.  Moreover, as $f$ is a Hopf morphism 
\[
f(\alpha_{i}^{(n)}) = f( \mathsf{e}(x_{i}^{(n)})) = \mathsf{e}(f( x_{i}^{(n)})) = \mathsf{e}(\beta_{i}^{(n)}) = \beta_{i}^{(n)}.
\]

Finally, repeat this construction for all $n \ge 1$.  By Proposition~\ref{prop:indecomposable generators} the sequences 
\[
\vec{A} = \big( (\alpha_{1}^{(n)}, \ldots, \alpha_{a_{n}}^{(n)}) \big)_{n \ge 1}
\qquad\text{and}\qquad
\vec{B} = \big( (\beta_{1}^{(n)}, \ldots, \beta_{b_{n}}^{(n)}) \big)_{n \ge 1}
\]
belong to $\OPG(H)$ and $\OPG(K)$ respectively, and by construction $f = f^{\vec{A}}_{\vec{B}}$.
\end{proof}

%\section{Classification of free cocommutative graded connected Hopf algebras} 
%
%Given a sequence $\vec{a} = (a_{1}, a_{2}, \ldots)$ of nonnegative integers, let $\mathfrak{L}(\vec{a})$ denote the free, graded Lie algebra with $a_{i}$ generators in degree $i$, and zero generators in degree zero.  The universal enveloping algebra
%\[
%\mathcal{U}\big(\mathfrak{L}(\vec{a})\big)
%\]
%is a cocommutative, graded, connected Hopf algebra, and we have shown that it is free, with Hilbert series
%\[
%\frac{1}{1 - a_{1}t - a_{2}t^{2} - a_{3}t^{3} - \cdots}.
%\]
%
%%\begin{thm}
%%Let $H=\bigoplus_{n\geq 0} H_n$ and $K=\bigoplus_{n\geq 0} K_n$ be two free graded connected cocommutative Hopf algebras. The following are equivalent.
%%\begin{enumerate}
%%\item $H\cong K$ as graded Hopf algebras. 
%%
%%\item $\dim(H_n)=\dim(K_n) \text{ for all } n\geq 0.$
%%\end{enumerate}   
%%\end{thm}
%%
%%\begin{proof}
%%Immediately we have (1)$\Rightarrow$(2). Assume that $\dim(H_n)=\dim(K_n) \text{ for all } n\geq 0,$
%%or equivalently $\mathcal{H}(H;t)=\mathcal{H}(K;t).$
%%Since both $H$ and $K$ are both freely generated, there exist graded sets
%%$X$ and $Y$ generating $H$ and $K$, respectively.
%%Define the series $\mathcal{G}(X;t)=\sum_{n\geq 0}|X_n|t^n$.
%%It follows from Proposition \ref{prop: free algebra hilbert series}
%%\mike{is this right?  I found "Prop. 3.2" in the text and
%%it no longer referred to the correct thing} that
%%\[
%%\mathcal{H}(H;t)=\frac{1}{1-\mathcal{G}(X;t)}\ \text{  and  }\ \mathcal{H}(K;t)=\frac{1}{1-\mathcal{G}(Y;t)}.
%%\]
%%Because $H$ and $K$ are connected, the degree zero terms of their Hilbert series $\dim(H_0)=\dim(K_0)=1$ are non-zero, hence the following equality of series
%%\[
%%\mathcal{G}(X;t)=1-\frac{1}{\mathcal{H}(H;t)}=1-\frac{1}{\mathcal{H}(K;t)}=\mathcal{G}(Y;t).
%%\]
%%We then have $|X_i|=|Y_i|$ for all $i\geq 0.$ Fix bijections $\varphi_i:X_i\to Y_i$ and extend
%%to a bijection $\varphi:X\to Y$. This graded bijection of generating sets induces a graded
%%Lie algebra isomorphism $\hat{\varphi}:\mathfrak{L}_X\to \mathfrak{L}_  Y$.\mike{How? reference?}
%%From Corollary~\ref{cor: free hopf primitives} we have
%%\[
%%\mathcal{P}(H)\cong \mathfrak{L}_X \text{ and } \mathcal{P}(K)\cong \mathfrak{L}_Y.
%%\]
%%We conclude by the Cartier-Milnor-Moore\mike{reference?} theorem that
%%\[
%%H\cong \mathcal{U}(\mathfrak{L}_X)\cong \mathcal{U}(\mathfrak{L}_Y)\cong K.
%%\]
%%\end{proof}
%
%
%\begin{thm}[Various Sources]
%Let $H$ be a free, cocommutative, graded, connected Hopf algebra, and let $\vec{a} = (a_{1}, a_{2}, \ldots, )$ count the number of free generators of $H$ in each degree.  
%\begin{enumerate}
%\item There is a graded isomorphism $H \cong \mathcal{U}\big(\mathfrak{L}(\vec{a})\big)$ of Hopf algebras.
%
%\item Every graded sub-Hopf algebra of $H$ is isomorphic to $\mathcal{U}\big(\mathfrak{L}(\vec{b})\big)$ for some sequence $\vec{b} = (b_{1}, b_{2}, \ldots)$.
%
%\item For every sequence $\vec{b} = (b_{1}, b_{2}, \ldots)$ with $b_{i} \le a_{i}$, $H$ has a graded sub-Hopf algebra isomorphic to $\mathcal{U}\big(\mathfrak{L}(\vec{b})\big)$.
%
%\end{enumerate}
%\end{thm}
%\begin{proof}
%Here is a sketch of what we need to formalize:
%\begin{enumerate}
%\item %Using Aliniaeifard--Thiem's result~\cite[Theorem 12]{AT22}, we only need to compare the Hilbert series of $H$ and $\mathcal{U}\big(\mathfrak{L}(\vec{a})\big)$ to prove this part.  \lucas{Should we write out their proof to convince ourselves it is true.  It is short.}
%
%Following Aliniaeifard--Thiem's result~\cite[Theorem 12]{AT22}, one only need to compare the Hilbert series of $H$ and $\mathcal{U}\big(\mathfrak{L}(\vec{a})\big)$.
%
%
%\item Let $G \subseteq H$ be a sub-Hopf algebra.  By (1), the Lie algebra of primitives $\mathcal{P}(H) \cong \mathcal{L}(\vec{a})$.  Thus $\mathcal{P}(G)$ is isomorphic to a subalgebra of $\mathcal{L}(\vec{a})$.  
%
%By~\cite[Theorem 2.2]{MSZ}, $\mathcal{P}(G)$ is a free Lie algebra, so there exists a sequence $\vec{b} = (b_{1}, b_{2}, \ldots)$ for which $\mathcal{P}(G) \cong \mathfrak{L}(\vec{b})$.
%%\lucas{Detail: show that this result plays well with the grading?}  
%By Milnor--Moore, $G \cong \mathcal{U}\big(\mathfrak{L}(\vec{b})\big)$.
%
%%Missing: what can we say about $\vec{b}$, i.e. the rank of $\mathcal{P}(G)$?  I really think it should satisfy $b_{i} \le a_{i}$, but free objects are weird so this needs a proof\lucas{Big detail!! This actually seems to be false}.  Since we are wrong here, we still could have a classification of sub-Hopf algebras by sequences $\vec{b}$, but we would need to figure out the correct constraints on $\vec{b}$.
%
%\item Here, we construct $\mathfrak{L}(\vec{b})$ as a subalgebra of $\mathfrak{L}(\vec{a})$ by taking $b_{i}$ of the free generators in degree $i$.
%\end{enumerate}
%\end{proof}
%
%Previously, we had thought that the condition in (3) above was sufficient, i.e. that every graded sub-Hopf algebra of $\mathcal{U}\big(\mathfrak{L}(\vec{a})\big)$ was isomorphic to $\mathcal{U}\big(\mathfrak{L}(\vec{b})\big)$ for some sequence $(b_{1}, b_{2}, \ldots)$ with $0 \le b_{i} \le a_{i}$ for all $i \ge 1$.  However, this is not true!  
%
%Consider the free, connected, cocommutative Hopf algebra which is freely generated as an algebra by four homogeneous elements of degree one, $x$, $y$, $z$, and $w$, so that
%\[
%H_{1} = \CC\operatorname{-span}\{x, y, z, w\}
%\]
%and
%\[
%H_{k} = \CC\operatorname{-span}\big\{ \text{products $m_{1} m_{2} \cdots m_{k}$} \;|\; m_{i} \in \{x, y, z, w\} \big\}
%\qquad\text{for $k \ge 2$}.
%\]
%By Proposition~\ref{prop: free algebra hilbert series}, $H$ has the Hilbert series
%\[
%\frac{1}{1 - 4t - 0 t^{2} - 0 t^{3} - \cdots }.
%\]
%
%The Lie algebra of primitives $\mathcal{P}(H)$ is the free Lie algebra $\mathfrak{L}_{\{x, y, z, w\}}$.  Now consider the Lie subalgebra
%\[
%M = \CC\operatorname{-span}\{[x, y]\} \subseteq \mathfrak{L}_{\{x, y, z, w\}},
%\]
%as well as its universal enveloping algebra $\mathcal{U}(M) \subseteq H$.
%By Theorem~\ref{}, this is a free Lie algebra generated by one element, and by dimension consideration we can take the free generator to be $[x, y]$.  
%Therefore by Theorem~\ref{}, the universal enveloping algebra $\mathcal{U}(M)$ is freely generated (as an algebra) by $[x, y]$.
%Now $[x, y] = xy - yx$ is a homogeneous element of degree $2$ in $H$, so as the subalgebra generated by $[x, y]$, the universal enveloping algebra $\mathcal{U}(M)$ is a graded sub-Hopf algebra and has Hilbert series
%\[
%\frac{1}{1 - 0t - t^{2} - 0t^{3} - \cdots}.
%\]
%Since $H$ has no free generators in degree $2$, this shows that sub-Hopf algebras may have more free generators in a given degree than the Hopf algebra which contains them.
%
%Is is also possible to obtain a sub-Hopf algebra which has more free generators (in total) than the Hopf algebra which contains it.  
%Consider the Lie subalgebra
%\[
%N = \langle [x, y], [x, z], [x, w], [y, z], [y, w], [z, w] \rangle \subseteq \mathfrak{L}_{\{x, y, z, w\}}.
%\]
%This is free on the set $\{[x, y], [x, z], [x, w], [y, z], [y, w], [z, w]\}$.  \lucas{Definitely true, but details needed.}  Repeating the argument we made for $\mathcal{U}(M)$, we have that $\mathcal{U}(N)$ is a graded sub-Hopf algebra of $H$ with six free generators in degree two, so that its Hilbert series is
%\[
%\frac{1}{1 - 0t - 6t^{2} - 0 t^{3} - \cdots }.
%\]
%
%\begin{question}
%Let $\vec{a} = (a_{1}, a_{2}, \ldots)$ be a sequence of nonnegative integers.  What characterizes the sequences $\vec{b} = (b_{1}, b_{2}, \ldots)$ for which $\mathcal{U}(\mathfrak{L}(\vec{a}))$ has a graded sub-Hopf algebra isomorphic to $\mathcal{U}(\mathfrak{L}(\vec{b}))$?
%\end{question}
%
%
%
%Given a sequence $\vec{a} = (a_1,a_2, \ldots)$ we have a formula for the dimension of the free Lie algebra with $a_i$ generators in each degree $i$~\cite[Theorem 2.2]{KK95}:
%\[
%\dim \mathfrak{L}(\vec{a})_n = \sum_{mk=n} \frac{1}{k}\mu (k) \mathbf{W}_m(\vec{a})
%\]
%where $\mu$ is the Mobius function, and setting $\lambda^!$ to be the multipllicity factorial and $\ell(\lambda)$ the length of $\lambda$,
%\[
%\mathbf{W}_m(\vec{a}) = \sum_{\lambda \vdash m} \frac{(\ell(\lambda)-1)!}{\lambda^!}a_{\lambda_1} \cdots a_{\lambda_{\ell}}.
%\]
%Define 
%\[
%P_n(\vec{a}) = \sum_{mk=n} \frac{1}{k}\mu (k) \mathbf{W}_m(\vec{a})
%\]
%so that $P_n(\vec{a}) = \dim \mathfrak{L}(\vec{a})_n$.
%
%\begin{theorem}
%\label{thm:subclassification1}
%    Let $\vec{a} = (a_{1}, a_{2}, \ldots)$ and $\vec{b} = (b_{1}, b_{2}, \ldots)$ be sequences of nonnegative integers. The following are equivalent.
%    \begin{enumerate}
%        \item $\mathcal{U}(\mathfrak{L}(\vec{a}))$ has a sub-Hopf algebra isomorphic to $\mathcal{U}(\mathfrak{L}(\vec{b}))$
%        \item $\mathfrak{L}(\vec{a})$ has a sub-Lie algebra isomorphic to $\mathfrak{L}(\vec{b})$.
%        \item $P_n(\vec{a}) \geq P_n(\vec{b})$ for all $n > 0$.
%    \end{enumerate}
%\end{theorem}
%
%\begin{proof}
%    The equivalence of (1) and (2) is clear. We will show (2) and (3) are equivalent. Suppose $\mathfrak{L}(\vec{a})$ has a sub-Lie algebra isomorphic to $\mathfrak{L}(\vec{b})$. Then
%    \[
%    P_n(\vec{b}) = \dim \mathfrak{L}(\vec{b})_n \leq \dim \mathfrak{L}(\vec{a})_n = P_n(\vec{a}).
%    \]
%
%    Now suppose $P_n(\vec{a}) \geq P_n(\vec{b})$ for all $n > 0$. We will construct a sub-Lie algebra $B \subseteq \mathfrak{L}(\vec{a})$ isomorphic to $\mathfrak{L}(\vec{b})$ by recursively choosing $b_n$-dimensional subspaces complementary to $[B,B]_n$ in each degree $n$. Let $V \subseteq \mathfrak{L}(\vec{a})$ be the subspace spanned by the free generators, so that $\mathfrak{L}(\vec{a}) = V \oplus [\mathfrak{L}(\vec{a}),\mathfrak{L}(\vec{a})]$. Note that we can recursively define 
%    \[ 
%    [B,B]_n = \sum_{k=1}^{n-1} [B_k,B_{n-k}].
%    \]
%
%    For $n=1$ we have $P_1(\vec{a}) = a_1$ and $P_1(\vec{b}) = b_1$, hence $a_1 \geq b_1$. Let $W_1$ be the span of $b_1$ of the degree 1 generators. Trivially $W_1$ is complementary to $[B,B]_1 = \{0\}.$
%    Suppose in each degree $1 \leq k < n$ we have chosen subspaces $W_k$ complementary to $[B,B]_k$. If $b_n \leq a_n$ we may simply choose a $b_n$-dimensional subspace of $V_n$. Otherwise, suppose $b_n > a_n$. Because $\mathfrak{L}(\vec{a})_n = V_n \oplus [\mathfrak{L}(\vec{a}),\mathfrak{L}(\vec{a})]_n$, we have
%    \[
%    \dim [\mathfrak{L}(\vec{a}),\mathfrak{L}(\vec{a})]_n = \dim \mathfrak{L}(\vec{a}) - \dim V_n = P_n(\vec{a}) - a_n.
%    \]
%    Because the spaces $B_k = W_k \oplus [B,B]_k$ are defined for $1 \leq k < n$, the space $[B,B]_n$ is defined recursively. Furthermore, $[B,B]_n$ is a subspace of $[\mathfrak{L}(\vec{a}),\mathfrak{L}(\vec{a})]_n$.
%    \\
%    \textit{Claim.} $\dim [B,B]_n = P_n(\vec{b}) - b_n$.
%    \\                    
%    
%    Given the claim, we have
%    \[
%    \dim \frac{[\mathfrak{L}(\vec{a}),\mathfrak{L}(\vec{a})]_n}{[B,B]_n} = P_n(\vec{a}) - a_n - \dim [B,B]_n \geq P_n(\vec{a}) - P_n(\vec{b}) + b_n - a_n \geq b_n - a_n. 
%    \]
%    Then we may choose $b_n - a_n$ linearly independent elements of $\frac{[\mathfrak{L}(\vec{a}),\mathfrak{L}(\vec{a})]_n}{[B,B]_n}$, and together with the $a_n$ generators in degree $n$ they span a $b_n$-dimensional subspace $W_n$ complementary to $[B,B]_n.$ Thus we have recursively defined 
%    \[
%    B = \bigoplus_{n\geq 1}W_n \oplus [B,B]_n = W \oplus [B,B].
%    \]
%    with $W = \bigoplus_{n\geq 1} W_n$ and $\dim W_n = b_n$.
%    
%    Clearly $B$ is closed under the Lie bracket, and is a sub-Lie algebra of $\mathfrak{L}(\vec{a}).$ By the Shirshov-Witt Theorem ~\cite[text]{S09}, $B$ is a free Lie algebra and is therefore generated by a basis for $W$, hence $B \cong \mathfrak{L}(\vec{b}).$
%\end{proof}
%
%\begin{proof}[Proof of Claim]
%Let $W_k$ be defined as above for $1 < k < n.$ Set $W_{<n} = \bigoplus_{k=1}^{n-1} W_k$ and let $\mathfrak{L}(W_{<n})$ be the free Lie algebra on $W_{<n}$  (this is equivalent to the free Lie algebra generated by a basis for $W_{<n}$). Since $\mathfrak{L}(W_{<n}) = W_{<n} \oplus [\mathfrak{L}(W_{<n}) , \mathfrak{L}(W_{<n})]$, we have $\mathfrak{L}(W_{<n})_1 = W_1 = B_1$, and recursively for $1 < k <n$ we have
%\[
%\mathfrak{L}(W_{<n})_k = W_k \oplus [\mathfrak{L}(W_{<n}) , \mathfrak{L}(W_{<n})]_k = W_k \oplus [B,B]_k = B_k
%\]
%therefore $[B,B]_n = [\mathfrak{L}(W_{<n}),\mathfrak{L}(W_{<n})]_n$.
%
%Define the sequence $\vec{b} \vert_n = (b_1,b_2, \ldots , b_{n-1}, 0, \ldots)$. Then $\dim \mathfrak{L}(W_{<n})_n = P_n(\vec{b}|_n)$. Because the only term of 
%\[ 
%P_n(\vec{b}) = \sum_{mk=n} \frac{1}{k}\mu (k) \sum_{\lambda \vdash m} \frac{(\ell(\lambda)-1)!}{\lambda^!}b_{\lambda_1} \cdots b_{\lambda_{\ell}}
%\]
%containing $b_n$ is with $m = n$ and $\lambda = (n)$ with a coefficient of $1$, we have $P_n(\vec{b}|_n) = P_n(\vec{b}) - b_n$. Therefore
%\[
%\dim [B,B]_n = \dim [\mathfrak{L}(W_{<n}),\mathfrak{L}(W_{<n})]_n = P_n(\vec{b}|_n) = P_n(\vec{b})-b_n.
%\]
%\end{proof}

%\section{A set of details to add}
%
%Aliniaeifard-Thiem \cite[Theorem 12]{AT22} give a theorem that says that two cocommutative Hopf algebras that
%have the same sequence of graded dimensions are isomorphic.  We should have a section here
%that says how to carry out this construction (outlined in the Cocalc summary for July 3).
%
%Let \(H\) and \(K\) be two free graded cocommutative Hopf algebras, such that \(\dim(H_n) = \dim(K_n)\) for all \(n \geq 0\).
%Aliniaeifard-Thiem  ~\cite[Theorem 12]{AT22}, guarantees that \(H \cong K\) and we outline here the method for constructing an 
%isomorphism \(f:H \to K\).  In general, the idea is to find the free primitive generators of \(H\) and \(K\), and map the primitive generators of 
%each graded component \(H_n\) to the primitive generators of the  coresponding graded component \(K_n\).
%
%Aguiar-Lauve \cite{AL15} give the Eulerian idempotent operator
%\[
%    \mathbf{e} = \sum_{k=1}^\infty \frac{(-1)^{k-1}}{k} m^{(k-1)}\circ \Delta^{(k-1)}
%\]
%which for any cocommutative Hopf algebra projects onto the space of primitive elements. Since \(H\) and \(K\) are cocommutative
%we can use \(\mathbf{e}\) to compute  \(\mathcal{P}(H)\) and \(\mathcal{P}(K)\).
%Then, by ~\ref{lemma:primitive generators}, there exists \(X \subseteq \mathcal{P}(H)\) such that \(H\) is generated by \(X\)
%and  \(Y \subseteq \mathcal{P}(K)\) such that  \(K\) is  generated by \(Y\).
%
%In order to distinguish the free primitive generators \(X\)
%from the primitive elements \(\mathcal{P}(H)\) consider the decomposition \[
%    \mathcal{P}(H) = V \oplus [\mathcal{P}(H), \mathcal{P}(H)]
%\] where \([\mathcal{P}(H), \mathcal{P}(H)] = \CC\operatorname{-span}\{[p1,p2] \: \vert \: p_i \in \mathcal{P}(H)\}\) and
%\(V\) is a graded subspace of \(\mathcal{P}(H)\). Since \(\mathcal{P}(H)\) forms a Lie algebra under the commutator bracket,
%then, by ~\cite[Prop 2.2]{F23}, \(\mathcal{P}(H)\) is generated by a basis of \(V\). Hence \(X\) is a basis of \(V\). Therefore, in general,
%to find the set of primitive generators of \(H\), first choose a graded subspace \(V \subseteq \mathcal{P}(H)\), then choose a basis for \(V\).
%Alternatively, letting \(V = \frac{\mathcal{P}(H)}{[\mathcal{P}(H), \mathcal{P}(H)]}\),
% any subset \(X' \subseteq \mathcal{P}(H)\) that descends to a basis of \(V\), will be a set primitive generators of \(H\).
%
%Let \(p_i\) be a basis of \(V\) and let  \(A \in GL_{|I|}(\CC)\) be an invertible linear transformation.
%Then, for some  \(b_i \in [\mathcal{P}(H), \mathcal{P}(H)]\),
%we can characterize all possible bases for \(V\) as \[
%    q_i = \sum_jA_{ij}p_i + b_i.
%\]
%Hence we find the free primitive generators \(X\) of \(H\) and \(Y\) of \(K\), and, as in the proof of
%\cite{AT22}, fix bijections \(f_i: X_i  \to Y_i\) and extend to a bijection
%\(f:X \to Y\).

%\section{Empty this section out}
%\lucas{TODO: This section is almost empty!  Let's finish clearing it out and delete it.}

%\mike{It would be nice to have an example of a sequence $\vec{h}$ that
%is not obvious that it doesn't have a Hopf algebra.
%For instance, $\vec{h} = (1,2,2,2,2,\ldots)$ is there a Hopf algebra?
%If yes, find me a different example.  If no, apply this theorem to explain why.}

\section{Classifying Hopf subalgebras by primitive dimensions}
\label{sec:subalgebras}

Let $H$ be an \FGCCHA.  
In this section we construct all the isomorphism classes of Hopf subalgebras of $H$; in particular we show that every Hopf subalgebra is an \FGCCHA satisfying a simple condition.
To begin, recall the functions $\phi_{a, p}$ and $\phi_{h, a}$ from Definition~\ref{defn:sequencetransfer}, and recall that for any nonnegative sequence $\vec{a} = (a_{1}, a_{2}, \ldots)$, we write $\mathfrak{L}(\vec{a})$ for the free Lie algebra generated by the graded set $X_{\vec{a}}$ with $a_{n}$ elements in degree $n$ as in Equation~\eqref{eq:La}.

\begin{theorem}
\label{thm:subclassification2}
Let $H$ be a free graded connected cocommutative Hopf algebra and let $\vec{p} = \vecdim(\mathcal{P}(H)_{n})$.  Then there is a bijection
\[
\begin{array}{rcl}
\left\{\begin{array}{c}
\text{Isomorphism classes of} \\
\text{Hopf subalgebras $K \subseteq H$}
\end{array}\right\}
& \leftrightarrow & 
\left\{\begin{array}{c}
\text{Sequences $\vec{b} \in \NN^{\ZZ_{+}}$} \\
\text{for which $\phi_{a, p}(\vec{b}) \le \vec{p}$} 
\end{array}\right\} \\[1.5em]
K & \mapsto & \phi_{h, a} \big( \vecdim(K)\big) \\
\mathcal{U}(\mathfrak{L}(\vec{b}))) & \mapsfrom & \vec{b}
\end{array}
\]
\end{theorem}

\begin{remark}
Using the sequence transfer maps from Definition~\ref{defn:sequencetransfer}, Theorem~\ref{thm:subclassification2} implies that isomorphisms of Hopf subalgebras of $H$ are also indexed by sequences $\vec{q} \in \NN^{\ZZ_{+}}$ for which $\vec{p} \ge \vec{q}$ and $\phi_{p, a}(\vec{q}) \in \NN^{\ZZ_{+}}$.
\end{remark}

The proof of Theorem~\ref{thm:subclassification2} will construct a Hopf subalgebra in $H$ isomorphic to each
$\mathcal{U}(\mathfrak{L}(\vec{b}))$.
Before completing the proof we will give several motivating examples and intermediate results.

\begin{example}
We illustrate a counterintuitive aspect of containment between \FGCCHAs. Let $H$ and $K$ be \FGCCHAs generated by graded sets with respective graded cardinalities $\vec{a}=(1,0,0,0,\dots)$ and $\vec{b}=(0,1,0,0,\dots)$, and further denote $\vec{h} = \vecdim(H)$ and $\vec{k} = \vecdim(K)$.
Using Proposition~\ref{prop:sequences}, we can compute that
\[
h_n = 1 \qquad\text{for all $n \ge 1$}.
\]
We can also compute that
\[
k_{n} = \begin{cases} 1 & \text{if $n$ is even,} \\ 0 & \text{if $n$ is odd,} \end{cases}
\]
as $b_{\beta} \neq 0$ implies that $\beta = (2, \ldots, 2)$.  
Therefore, $\vec{k} \le \vec{h}$, so one might expect that $H$ should contain a Hopf subalgebra isomorphic to $K$.  
However Theorem~\ref{thm:subclassification2} tells us this is not the case: $\phi_{a,p}(\vec{a}) = \vec{a}$, $\phi_{a, p}(\vec{b}) = \vec{b}$, and $\vec{a}$ and $\vec{b}$ are incomparable.
\end{example}

\begin{example}
\label{ex:NSymInCxy}
Recall the \FGCCHA $K = \CC\langle u, v \rangle$ from Example~\ref{ex:quotientHopf}, so that $u$ and $v$ have degree one.  Then $\vec{p} = \vecdim(\mathcal{P}(K))$ is the sequence
$\vec{p} = (2, 1, 2, 3, 6, 9, 18, 30,\ldots)$~\cite[\href{https://oeis.org/A001037}{A001037}]{OEIS} given by 
\[
p_{n} = \frac{1}{n} \sum_{d | n} \mu(n/d) 2^{d}.
\]

Then we can take 
\[
\vec{q} = \vec{p} - (1, 0, 0, \ldots)
\]
so that clearly $\vec{p} \ge \vec{q}$.  
The sequence $\vec{q}$ is identified in~\cite[\href{https://oeis.org/A059966}{A059966}]{OEIS}, and direct computation then gives that
\[
\phi_{p, a}(\vec{q}) = (1, 1, 1, \ldots) \in \NN^{\ZZ_{+}},
\]
so this sequence determines a subalgebra isomorphic to $\mathcal{U}(\mathfrak{L}(1, 1, 1, \ldots))$ inside of $K$.   
In Example~\ref{ex:NSym} we identify $\mathcal{U}(\mathfrak{L}(1, 1, 1, \ldots)) \cong \mathsf{NSym}$, so $K$ has a Hopf subalgebra isomorphic to $\mathsf{NSym}$.
\end{example}

We now state and prove an intermediate result in the proof of Theorem~\ref{thm:subclassification2}; the proof of the theorem follows.  Recall the definition of the derived subalgebra $[L, L]$ of a graded Lie algebra $L$ from Equation~\eqref{eq:derivedLiesubalgebra}.

\begin{lemma}
\label{lem:deriveddimension}
Let $\vec{a} = (a_{1}, a_{2}, \ldots) \in \NN^{\ZZ_{+}}$.  Then
\[
\vecdim([\mathfrak{L}(\vec{a}), \mathfrak{L}(\vec{a})]) = \phi_{a, p}(\vec{a}) - \vec{a},
\]
or equivalently $\vec{a} = \vecdim\big(\mathfrak{L}(\vec{a})\big/ [\mathfrak{L}(\vec{a}), \mathfrak{L}(\vec{a})]\big)$.
\end{lemma}
\begin{proof}
Using Proposition~\ref{prop:indecomposable generators}, $ \mathfrak{L}(\vec{a}) = \CC X_{\vec{a}} \oplus [\mathfrak{L}(\vec{a}), \mathfrak{L}(\vec{a})]$.  Taking the dimension vector of each space, we obtain an equivalent equation.
\end{proof}

\begin{lemma}[Shirshov--Witt Theorem~\cite{S09, Witt56}]
\label{lem:ShiWitt}
Every Lie subalgebra of a free Lie algebra is free.
\end{lemma}


\begin{proof}[Proof of Theorem~\ref{thm:subclassification2}]
We first show the map $K \mapsto \phi_{h, a} \big( \vecdim(K)\big)$ is injective.  Suppose that $J$ and $K$ are Hopf subalgebras of $H$ with the property that $\phi_{h, a} \big(\vecdim(J)) = \phi_{h, a} \big(\vecdim(K))$.  
Since $\phi_{h, a}$ is invertible by Proposition~\ref{prop:sequences} $\vecdim(J) = \vecdim(K)$.  We therefore conclude by Theorem~\ref{thm:AT} that $J \cong K$.

Now suppose that $\vec{b} \in \NN^{\ZZ_{+}}$ has the property that $\vec{q} = \phi_{a, p}(\vec{b}) \le \vec{p}$.  
We will construct a Hopf subalgebra $K$ of $H$ which is isomorphic to $\mathcal{U}(\mathfrak{L}(\vec{b}))$; by Proposition~\ref{prop:sequences} this will show that the  map $K \mapsto \phi_{h, a} \big( \vecdim(K)\big)$ is surjective, completing the proof.

There is some subtlety to defining $K$.  Since we have not assumed that $a_{n} \ge b_{n}$, we cannot take $K$ to be generated by some subset of the free generators of $H$, and may have to choose elements of $H^{2}_{+}$ as generators for $K$.  
These choices cannot always be expressed uniformly, so we resort to an inductive argument to demonstrate their existence.  
Specifically, we construct a tower of Lie subalgebras 
\[
0 = L^{(1)} \subseteq L^{(2)} \subseteq L^{(3)} \subseteq \cdots \subseteq \mathcal{P}(H)
\]
such that 
\[
L^{(n)} \cong \mathfrak{L}(b_{1}, \ldots, b_{n-1}, 0, 0, \ldots).
\]
Taking $L^{(\infty)}$ to be the union of the $L^{(n)}$, we obtain $K$ as $\mathcal{U}(L^{(\infty)}) \subseteq \mathcal{U}(\mathcal{P}(H)) = H$.

We proceed by induction with case case $L^{(1)} = 0$.  
We then assume inductively that $L^{(n)}$ has been constructed.  
By Lemma~\ref{lem:deriveddimension} and our inductive hypothesis,
\[
\vecdim([L^{(n)}, L^{(n)}])
 = 
\phi_{a, p}(b_{1}, \ldots, b_{n-1}, 0, 0, \ldots) - (b_{1}, \ldots, b_{n-1}, 0, 0, \ldots).
\]
Thus $\vecdim([L^{(n)}, L^{(n)}])_{n}$ is equal to the $n$th term of $\phi_{a, p}(b_{1}, \ldots, b_{n-1}, 0, 0, \ldots)$, which is also equal to $\vecdim(L^{(n)})_{n}$.  
We can further deduce, after a careful examination of the definition of $\phi_{a, p}$, that
\begin{equation}
\label{eq:inductivedimensionequality}
\phi_{a, p}(b_{1}, \ldots, b_{n-1}, 0, 0, \ldots)_{n}
=
\phi_{a, p}(\vec{b})_{n} - b_{n}
=
q_{n} - b_{n}.
\end{equation}
Therefore,
\[
\vecdim\left( \mathcal{P}(H) \big/ [L^{(n)}, L^{(n)}] \right)_{n}
= p_{n} - (q_{n} - b_{n})
= b_{n} + (p_{n} - q_{n})
\ge b_{n}.
\]

The preceding inequality shows that we can choose $b_{n}$ linearly independent elements $\{x^{(n)}_{1}, \ldots, x^{(n)}_{b_{n}}\}$ of $\mathcal{P}(H)_{n}$ which remain linearly independent modulo $[L^{(n)}, L^{(n)}]$ and define $L^{(n+1)}$ to be the Lie algebra generated by  elements of $L^{(n)}$ as well as $x^{(n)}_{1}, \ldots, x^{(n)}_{b_{n}}$.

%\[
%L^{(n+1)} = \langle L^{(n)}, x^{(n)}_{1}, \ldots, x^{(n)}_{b_{n}} \rangle.
%\]
Since $L^{(n+1)}$ is a sub-Lie algebra of a free Lie algebra, namely $\mathcal{P}(H)$, Lemma~\ref{lem:ShiWitt} states that $L^{(n+1)}$ is also free.  
As $L^{(n+1)}$ is generated by any generating set of $L^{(n)}$ and $b_{n}$-many homogeneous elements of degree $n$, we deduce that
\[
L^{(n+1)} \cong \mathfrak{L}(b_{1}, \ldots, b_{n-1}, b_{n}', 0, \ldots )
\qquad\text{for some $b_{n}' \le b_{n}$}.
\]
The final step of the proof is to show that $b_{n}' = b_{n}$.  Using Lemma~\ref{lem:deriveddimension} and the definition of $L^{(n+1)}$,
\begin{align*}
b_{n}' &= \dim\left( L^{(n+1)}_{n} \big/ [L^{(n+1)}, L^{(n+1)}]_{n}\right)% \\
%&= \dim\left(  \CC\operatorname{-span}\{x^{(n)}_{1}, \ldots, x^{(n)}_{b_{n}}\} \oplus [L^{(n)}, L^{(n)}]_{n} \big/ [L^{(n)}, L^{(n)}]_{n} \right) \\
%&= b_{n}. \qedhere
\end{align*}
Then $[L^{(n+1)}, L^{(n+1)}]_{n} = [L^{(n)}, L^{(n)}]_{n}$ as $L^{(n)}$ and $L^{(n+1)}$ contain the same homogeneous elements of degree $n - 1$ and less.  Therefore,
\begin{align*}
 \dim\!\left( L^{(n+1)}_{n} \big/ [L^{(n+1)}, L^{(n+1)}]_{n}\right) 
&= \dim\!\left(  \CC\operatorname{-span}\{x^{(n)}_{1}, \ldots, x^{(n)}_{b_{n}}\} \oplus [L^{(n)}, L^{(n)}]_{n} \big/ [L^{(n)}, L^{(n)}]_{n} \right) \\
&= b_{n}.
\end{align*}
\end{proof}

%\begin{example}
%Building on Example~\ref{ex:NSymInCxy}, we construct an isomorphic copy of $\mathsf{NSym}$ inside of $H = \CC\langle x, y \rangle$ in the manner of the above proof.  
%This means that for each degree $n \ge 1$, we will choose a primitive element $x^{(n)}_{1}$ in degree $n$ that is linearly independent of all commutators in generators $x_{1}^{(i)}$ for $i < n$, and then define
%\[
%L = \langle x_{1}^{(1)}, x_{1}^{(2)}, x_{1}^{(3)}, \ldots \rangle. 
%\]
%
%In degree $1$, there are no constrains and we choose 
%\[
%x_{1}^{(1)} = x.
%\]
%In higher degrees, we let
%\[
%x_{1}^{(n)} = \underbrace{[y, [y, \cdots [y}_{\text{$n-1$ times}}, x] \cdots]].
%\]
%To see that $x_{1}^{(n)}$ is linearly independent of all commutators in $x_{1}^{(i)}$ for $i < n$, we consider the number of times $x$ occurs in any generator or bracket of generators.  
%This will be $1$ if we have a generator and $k$ for a bracket of $k$ generators, and moreover remains constant on terms in any Jacobi relation or anti-commutation relation.  
%Thus, $L_{n}$ is graded by this statistic, with the degree $1$ component being the span of $x_{1}^{(n)}$, and the sum of components of degree $2$ or greater comprising all commutators of the $x_{1}^{(i)}$ for $i < n$.  
%\end{example}
%
%\begin{example}
%\lucas{GROUP TODO: Examples from earlier versions....do we keep?}
%\felix{If we want to talk about the idea we had in first place about the sequences then this can be a good counterexample otherwise I think we can let it go}
%\lucas{I generally agree, though this was a fun example to work out.}
%The Lie algebra of primitives $\mathcal{P}(H)$ is the free Lie algebra $\mathfrak{L}_{\{x, y, z, w\}}$.  Now consider the Lie subalgebra
%\[
%M = \CC\operatorname{-span}\{[x, y]\} \subseteq \mathfrak{L}_{\{x, y, z, w\}},
%\]
%as well as its universal enveloping algebra $\mathcal{U}(M) \subseteq H$.
%By Theorem~\ref{}, this is a free Lie algebra generated by one element, and by dimension consideration we can take the free generator to be $[x, y]$.  
%Therefore by Theorem~\ref{}, the universal enveloping algebra $\mathcal{U}(M)$ is freely generated (as an algebra) by $[x, y]$.
%Now $[x, y] = xy - yx$ is a homogeneous element of degree $2$ in $H$, so as the subalgebra generated by $[x, y]$, the universal enveloping algebra $\mathcal{U}(M)$ is a graded sub-Hopf algebra and has Hilbert series
%\[
%\frac{1}{1 - 0t - t^{2} - 0t^{3} - \cdots}.
%\]
%Since $H$ has no free generators in degree $2$, this shows that sub-Hopf algebras may have more free generators in a given degree than the Hopf algebra which contains them.
%
%Is is also possible to obtain a sub-Hopf algebra which has more free generators (in total) than the Hopf algebra which contains it.  
%Consider the Lie subalgebra
%\[
%N = \langle [x, y], [x, z], [x, w], [y, z], [y, w], [z, w] \rangle \subseteq \mathfrak{L}_{\{x, y, z, w\}}.
%\]
%This is free on the set $\{[x, y], [x, z], [x, w], [y, z], [y, w], [z, w]\}$.  \lucas{Definitely true, but details needed.}  Repeating the argument we made for $\mathcal{U}(M)$, we have that $\mathcal{U}(N)$ is a graded sub-Hopf algebra of $H$ with six free generators in degree two, so that its Hilbert series is
%\[
%\frac{1}{1 - 0t - 6t^{2} - 0 t^{3} - \cdots }.
%\]
%\end{example}
%

%\begin{proposition}
%    Let $H$ be a free graded connected cocommutative Hopf algebra, let $\mathbf{g} = (g_1,g_2,\ldots )$ be a sequence of nonnegative integers. There exists a sub-Hopf algebra $G \leq H$ with $\dim G_n = g_n$ for all $n \geq 0$ if and only if the following hold:
%    \begin{itemize}
%        \item[i)] $\displaystyle \sum_{\beta \vDash n} (-1)^{\ell(\beta)-1} g_\beta \geq 0 \text{ for all } n \geq 0.$
%        \item[ii)] $\displaystyle \sum_{d|n} \sum_{\beta \vdash d} \frac{d\cdot \mu(n/d) (-1)^{\ell(\beta)-1}}{n \cdot \ell(\beta)} g_\beta \leq \sum_{d|n} \sum_{\beta \vdash d} \frac{d\cdot \mu(n/d) (-1)^{\ell(\beta)-1}}{n \cdot \ell(\beta)} h_\beta$ for all $n \geq 0$
%    \end{itemize}
%\end{proposition}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{plain}
\bibliography{bibliography}{}


%\newpage
% \begin{table}[h]
%    \hspace*{-1cm} 
%    \begin{tabular}{|l|l|l|l||l|l|l||l|l|l|l||l|l|l|}
%        \hline
%        Sequence & h sequence & a sequence & p sequence \\
%        \hline
%        \href{https://oeis.org/A000108}{Catalan} & \(1, 2, 5, 14\) & 
%        \(1, 1, 2, 5, 14, 42, 132, 429, 1430\) & 
%        \(1, 1, 3, 8, 25, 75, 245, 800, 2700\) \\
%        
%        %\hline
%        %\href{https://oeis.org/A001764}%{Ternary Trees} & \(1, 3, 12, 55,273\) & 
%        %\(1, 2, 7, 30, 143, 728, 3876, %21318, 120175, 690690\) & 
%        %\(1, 2, 9, 40, 200, 1026, 5537, %30624, 173583, 1001400\)
%        %\\
%        
%        \hline
%        \href{https://oeis.org/A001006}{Motzkin}  & \(1, 2, 4, 9, 21\) & 
%        \(1, 1, 1, 2, 4, 9, 21, 51, 127, 323\) & 
%        \(1, 1, 2, 4, 10, 22, 56, 136, 348, 890\)
%
%          \\
%        \hline
%        \href{https://oeis.org/A000045}{ Fibonacci}
%        & \(1, 1, 2, 3,5\) & 
%        \(1, 0, 1, 0, 1, 0, 1, 0, 1, 0\) & 
%        \(1, 0, 1, 1, 2, 2, 4, 5, 8, 11\)
%
%         \\
%        \hline
%        \href{https://oeis.org/A000073}{Tribonacci} & \(0, 1, 1, 2, 4\) & 
%        \(0, 1, 1, 1, 2, 3, 4, 6, 9, 13\) & 
%        \(0, 1, 1, 1, 3, 4, 8, 13, 23, 38\)
%
%             \\
%        \hline
%        \href{https://oeis.org/A000032}{Lucas} & \(2, 1, 3, 4, 7\) & 
%        \(2, -3, 7, -13, 27, -53, 107, -213, 427, -853\) & 
%        \(2, -2, 3, -2, 8, -9, 22, -25, 64, -94\)
%
%         \\
%        \hline
%        \href{https://oeis.org/A000110}{Bell}
%         & \(1, 2, 5, 15, 52\) & 
%        \(1, 1, 2, 6, 22, 92, 426, 2146, 11624, 67146\) & 
%        \(1, 1, 3, 9, 34, 135, 610, 2965, 15612, 87871\)
%
%
%   \\
%        \hline
%\href{https://oeis.org/A000009}{Odd Part.}
%         & \(1, 1, 2, 2, 3\) & 
%        \(1, 0, 1, -1, 1, -1, 1, -2, 2, -2\) & 
%        \(1, 0, 1, 0, 1, 0, 1, 0, 1, 0\)
%
%   \\   
%        \hline
%        \href{https://oeis.org/A000272}{Park. Func.}
%         & \(1,3, 16, 125\) & 
%        \(1, 2, 11, 92, 1014, 13795, 223061\) & 
%        \(1, 2, 13, 106, 1145, 15204, 241630\)
%
%   \\  
%        \hline
%    \end{tabular}
%    \caption{Sequences}
%    \label{tab:sequences}
%\end{table}
%
%Rooted trees (Grossman-Larson, Connes-Kreimer),
%ordered trees (Grossman-Larson),
%heap-ordered trees (Grossman-Larson),
%planar binary trees (Loady-Ronco), permutations (Malvenuto-Reutenauer, Aguiar-Sottile),
%compositions (QSym/NSym), odd compositions (Peak algebra of Stembridge),
%parking functions ($(n+1)^{n-1}$).
%Set partitions.

\end{document}
%))